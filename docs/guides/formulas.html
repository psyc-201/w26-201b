<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical Formula Reference – PSYC 201B</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a936dd0cd06bcb31d39d5fba7942d483.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="https://cdn.jsdelivr.net/npm/@marimo-team/islands@0.14.16/dist/main.js"></script>
<link href="https://cdn.jsdelivr.net/npm/@marimo-team/islands@0.14.16/dist/style.css" rel="stylesheet" crossorigin="anonymous">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&amp;family=Lora&amp;family=PT+Sans:wght@400;700&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">
</head><body class="nav-sidebar docked nav-fixed quarto-light"><marimo-filename hidden=""></marimo-filename>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../assets/custom.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo25.png" alt="" class="navbar-logo light-content">
    <img src="../logo25.png" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 201B</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-guides--resources" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Guides &amp; Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-guides--resources">    
        <li>
    <a class="dropdown-item" href="../guides/terminology.html">
 <span class="dropdown-text">Course Terminology</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../guides/git-guide.html">
 <span class="dropdown-text">Git &amp; Github</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../guides/classroom-guide.html">
 <span class="dropdown-text">Github Classroom</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../guides/python-guide.html">
 <span class="dropdown-text">Python</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://psyc201b.github.io/PSYC-201B/"> 
<span class="menu-text">Previous course versions</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/psyc-201/w26-201b" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Statistical Formula Reference</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
  <div id="quarto-announcement" data-announcement-id="49207cc827a4c46bd5a79ca526f44b0e" class="alert alert-success hidden"><i class="bi bi-megaphone-fill quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Site Updates:</strong> Week 02 slides (Mon), Lab 01 materials (view only), updated course Schedule.</p>
</div></div>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/01/lab/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">“Pre-flight” Lab Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/01/lab/python-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python Fundamentals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/01/lab/polars-crash-course.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polars Crash Course</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#quick-reference" id="toc-quick-reference" class="nav-link active" data-scroll-target="#quick-reference">Quick Reference</a>
  <ul class="collapse">
  <li><a href="#notation-key" id="toc-notation-key" class="nav-link" data-scroll-target="#notation-key">Notation Key</a></li>
  <li><a href="#greek-letters-quick-reference" id="toc-greek-letters-quick-reference" class="nav-link" data-scroll-target="#greek-letters-quick-reference">Greek Letters Quick Reference</a></li>
  </ul></li>
  <li><a href="#model-based-thinking-foundations" id="toc-model-based-thinking-foundations" class="nav-link" data-scroll-target="#model-based-thinking-foundations">Model-Based Thinking Foundations</a>
  <ul class="collapse">
  <li><a href="#statistical-model" id="toc-statistical-model" class="nav-link" data-scroll-target="#statistical-model">The Statistical Model</a></li>
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals">Residuals</a></li>
  </ul></li>
  <li><a href="#the-general-linear-model" id="toc-the-general-linear-model" class="nav-link" data-scroll-target="#the-general-linear-model">The General Linear Model</a>
  <ul class="collapse">
  <li><a href="#glm-equation" id="toc-glm-equation" class="nav-link" data-scroll-target="#glm-equation">The GLM Equation</a></li>
  <li><a href="#design-matrix" id="toc-design-matrix" class="nav-link" data-scroll-target="#design-matrix">Design Matrix Structure</a></li>
  <li><a href="#ols-estimator" id="toc-ols-estimator" class="nav-link" data-scroll-target="#ols-estimator">OLS Estimator</a></li>
  <li><a href="#variance-of-coefficients" id="toc-variance-of-coefficients" class="nav-link" data-scroll-target="#variance-of-coefficients">Variance of Coefficients</a></li>
  <li><a href="#standard-errors" id="toc-standard-errors" class="nav-link" data-scroll-target="#standard-errors">Standard Errors</a></li>
  <li><a href="#residual-variance" id="toc-residual-variance" class="nav-link" data-scroll-target="#residual-variance">Residual Variance Estimate</a></li>
  </ul></li>
  <li><a href="#model-fit-and-comparison" id="toc-model-fit-and-comparison" class="nav-link" data-scroll-target="#model-fit-and-comparison">Model Fit and Comparison</a>
  <ul class="collapse">
  <li><a href="#r-squared" id="toc-r-squared" class="nav-link" data-scroll-target="#r-squared">R-squared</a></li>
  <li><a href="#adjusted-r-squared" id="toc-adjusted-r-squared" class="nav-link" data-scroll-target="#adjusted-r-squared">Adjusted R-squared</a></li>
  <li><a href="#f-statistic" id="toc-f-statistic" class="nav-link" data-scroll-target="#f-statistic">F-statistic</a></li>
  <li><a href="#likelihood-ratio-test" id="toc-likelihood-ratio-test" class="nav-link" data-scroll-target="#likelihood-ratio-test">Likelihood Ratio Test</a></li>
  </ul></li>
  <li><a href="#inference-and-uncertainty" id="toc-inference-and-uncertainty" class="nav-link" data-scroll-target="#inference-and-uncertainty">Inference and Uncertainty</a>
  <ul class="collapse">
  <li><a href="#t-statistic" id="toc-t-statistic" class="nav-link" data-scroll-target="#t-statistic">t-statistic for Coefficients</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence Intervals</a></li>
  <li><a href="#standard-error-mean" id="toc-standard-error-mean" class="nav-link" data-scroll-target="#standard-error-mean">Standard Error of the Mean</a></li>
  </ul></li>
  <li><a href="#different-outcome-types" id="toc-different-outcome-types" class="nav-link" data-scroll-target="#different-outcome-types">Different Outcome Types</a>
  <ul class="collapse">
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression Model</a></li>
  <li><a href="#odds-ratio" id="toc-odds-ratio" class="nav-link" data-scroll-target="#odds-ratio">Odds Ratio</a></li>
  </ul></li>
  <li><a href="#resampling-methods" id="toc-resampling-methods" class="nav-link" data-scroll-target="#resampling-methods">Resampling Methods</a>
  <ul class="collapse">
  <li><a href="#bootstrap-ci" id="toc-bootstrap-ci" class="nav-link" data-scroll-target="#bootstrap-ci">Bootstrap Percentile CI</a></li>
  <li><a href="#power" id="toc-power" class="nav-link" data-scroll-target="#power">Power</a></li>
  </ul></li>
  <li><a href="#mixed-models" id="toc-mixed-models" class="nav-link" data-scroll-target="#mixed-models">Mixed Models</a>
  <ul class="collapse">
  <li><a href="#random-intercept" id="toc-random-intercept" class="nav-link" data-scroll-target="#random-intercept">Random Intercept Model</a></li>
  <li><a href="#icc" id="toc-icc" class="nav-link" data-scroll-target="#icc">ICC (Intraclass Correlation)</a></li>
  </ul></li>
  <li><a href="#linear-algebra-essentials" id="toc-linear-algebra-essentials" class="nav-link" data-scroll-target="#linear-algebra-essentials">Linear Algebra Essentials</a>
  <ul class="collapse">
  <li><a href="#vectors-matrices" id="toc-vectors-matrices" class="nav-link" data-scroll-target="#vectors-matrices">Vectors and Matrices</a></li>
  <li><a href="#matrix-operations" id="toc-matrix-operations" class="nav-link" data-scroll-target="#matrix-operations">Matrix Operations</a></li>
  <li><a href="#eigendecomposition" id="toc-eigendecomposition" class="nav-link" data-scroll-target="#eigendecomposition">Eigenvalue Decomposition</a></li>
  </ul></li>
  <li><a href="#pca-and-dimensionality-reduction" id="toc-pca-and-dimensionality-reduction" class="nav-link" data-scroll-target="#pca-and-dimensionality-reduction">PCA and Dimensionality Reduction</a>
  <ul class="collapse">
  <li><a href="#pca-covariance" id="toc-pca-covariance" class="nav-link" data-scroll-target="#pca-covariance">PCA via Covariance Matrix</a></li>
  <li><a href="#variance-explained" id="toc-variance-explained" class="nav-link" data-scroll-target="#variance-explained">Proportion of Variance Explained</a></li>
  </ul></li>
  <li><a href="#regularization" id="toc-regularization" class="nav-link" data-scroll-target="#regularization">Regularization</a>
  <ul class="collapse">
  <li><a href="#ridge-regression" id="toc-ridge-regression" class="nav-link" data-scroll-target="#ridge-regression">Ridge Regression</a></li>
  <li><a href="#lasso-regression" id="toc-lasso-regression" class="nav-link" data-scroll-target="#lasso-regression">Lasso Regression</a></li>
  </ul></li>
  <li><a href="#alphabetical-index" id="toc-alphabetical-index" class="nav-link" data-scroll-target="#alphabetical-index">Alphabetical Index</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistical Formula Reference</h1>
<p class="subtitle lead">Formulas, Python Code, and Intuitions for PSYC 201B</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled" title="How to Use This Reference">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>How to Use This Reference
</div>
</div>
<div class="callout-body-container callout-body">
<p>This guide serves as both a <strong>quick lookup</strong> and a <strong>learning resource</strong>. Each formula includes:</p>
<ul>
<li><strong>The formula itself</strong> — always visible</li>
<li><strong>Intuition</strong> — what it means conceptually (click to expand)</li>
<li><strong>Python code</strong> — how to compute it (click to expand)</li>
<li><strong>Common pitfalls</strong> — mistakes to avoid</li>
</ul>
<p><strong>Quick Jump:</strong> <a href="#notation-key">Notation</a> | <a href="#the-general-linear-model">GLM</a> | <a href="#model-fit-and-comparison">Model Fit</a> | <a href="#inference-and-uncertainty">Inference</a> | <a href="#different-outcome-types">Logistic</a> | <a href="#resampling-methods">Resampling</a> | <a href="#mixed-models">Mixed Models</a> | <a href="#linear-algebra-essentials">Linear Algebra</a> | <a href="#pca-and-dimensionality-reduction">PCA</a> | <a href="#alphabetical-index">Index</a></p>
</div>
</div>
<hr>
<section id="quick-reference" class="level2">
<h2 class="anchored" data-anchor-id="quick-reference">Quick Reference</h2>
<section id="notation-key" class="level3">
<h3 class="anchored" data-anchor-id="notation-key">Notation Key</h3>
<p>Throughout this guide, we use consistent notation:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Symbol</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(y\)</span></td>
<td>Outcome/dependent variable (single observation)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{y}\)</span></td>
<td>Vector of all outcomes (<span class="math inline">\(n \times 1\)</span>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x\)</span></td>
<td>Predictor/independent variable (single value)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{X}\)</span></td>
<td>Design matrix (<span class="math inline">\(n \times p\)</span>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta\)</span></td>
<td>Population parameter (true coefficient)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\hat{\beta}\)</span></td>
<td>Estimated coefficient (from data)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\boldsymbol{\beta}\)</span></td>
<td>Vector of all coefficients</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\epsilon\)</span></td>
<td>Error term (population)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(e\)</span> or <span class="math inline">\(\hat{\epsilon}\)</span></td>
<td>Residual (sample estimate of error)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(n\)</span></td>
<td>Sample size (number of observations)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(p\)</span></td>
<td>Number of predictors (not counting intercept)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma^2\)</span></td>
<td>Population variance</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td>Estimated variance</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{I}\)</span></td>
<td>Identity matrix</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mathbf{X}^T\)</span></td>
<td>Transpose of matrix <span class="math inline">\(\mathbf{X}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{X}^{-1}\)</span></td>
<td>Inverse of matrix <span class="math inline">\(\mathbf{X}\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="greek-letters-quick-reference" class="level3">
<h3 class="anchored" data-anchor-id="greek-letters-quick-reference">Greek Letters Quick Reference</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Letter</th>
<th>Name</th>
<th>Common Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\alpha\)</span></td>
<td>alpha</td>
<td>Significance level (e.g., 0.05)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta\)</span></td>
<td>beta</td>
<td>Regression coefficients</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\gamma\)</span></td>
<td>gamma</td>
<td>Group-level coefficients (mixed models)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\epsilon\)</span></td>
<td>epsilon</td>
<td>Error/residual term</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\lambda\)</span></td>
<td>lambda</td>
<td>Regularization parameter</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mu\)</span></td>
<td>mu</td>
<td>Population mean</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sigma\)</span></td>
<td>sigma</td>
<td>Standard deviation</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma^2\)</span></td>
<td>sigma-squared</td>
<td>Variance</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\tau\)</span></td>
<td>tau</td>
<td>Random effect variance</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\chi^2\)</span></td>
<td>chi-squared</td>
<td>Chi-squared distribution/statistic</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="model-based-thinking-foundations" class="level2">
<h2 class="anchored" data-anchor-id="model-based-thinking-foundations">Model-Based Thinking Foundations</h2>
<p>Before diving into specific formulas, let’s establish the core idea that underlies everything in this course.</p>
<section id="statistical-model" class="level3">
<h3 class="anchored" data-anchor-id="statistical-model">The Statistical Model</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[y = f(x) + \epsilon\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(y\)</span> = observed outcome (what we measure)</li>
<li><span class="math inline">\(f(x)\)</span> = systematic component (what we’re trying to model)</li>
<li><span class="math inline">\(\epsilon\)</span> = random error (what we can’t explain)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Every statistical model has the same basic structure: <strong>Data = Model + Error</strong></p>
<p>The model (<span class="math inline">\(f(x)\)</span>) captures the <em>predictable</em> part — the pattern or relationship we believe exists. The error (<span class="math inline">\(\epsilon\)</span>) captures everything else — measurement noise, individual differences, factors we didn’t measure.</p>
<p><strong>The goal of modeling</strong> is to find an <span class="math inline">\(f(x)\)</span> that explains as much of <span class="math inline">\(y\)</span> as possible, leaving only random noise in <span class="math inline">\(\epsilon\)</span>.</p>
<p><strong>Where it comes from:</strong> This isn’t derived — it’s a <em>framework</em> for thinking about data. We <em>choose</em> to decompose observations this way because it’s useful.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Conceptual Example">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Conceptual Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="30e2840a" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># Simulating this idea:</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># True relationship (unknown in practice)</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">def</span> true_f(x):</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="cf">return</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x  <span class="co"># intercept=2, slope=3</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># Generate data</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb1-11"><a href="#cb1-11"></a>epsilon <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, size<span class="op">=</span><span class="dv">5</span>)  <span class="co"># random error</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>y <span class="op">=</span> true_f(x) <span class="op">+</span> epsilon  <span class="co"># observed data</span></span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="bu">print</span>(<span class="ss">f"x: </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="bu">print</span>(<span class="ss">f"true f(x): </span><span class="sc">{</span>true_f(x)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="bu">print</span>(<span class="ss">f"error: </span><span class="sc">{</span>epsilon<span class="sc">.</span><span class="bu">round</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="bu">print</span>(<span class="ss">f"observed y: </span><span class="sc">{</span>y<span class="sc">.</span><span class="bu">round</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="residuals" class="level3">
<h3 class="anchored" data-anchor-id="residuals">Residuals</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[e_i = y_i - \hat{y}_i\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(e_i\)</span> = residual for observation <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(y_i\)</span> = observed value</li>
<li><span class="math inline">\(\hat{y}_i\)</span> = predicted/fitted value</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Residuals are the <strong>leftover</strong> after your model makes its prediction. They’re your best estimate of the error term <span class="math inline">\(\epsilon\)</span>.</p>
<ul>
<li><strong>Positive residual</strong> (<span class="math inline">\(e_i &gt; 0\)</span>): Model under-predicted (actual &gt; predicted)</li>
<li><strong>Negative residual</strong> (<span class="math inline">\(e_i &lt; 0\)</span>): Model over-predicted (actual &lt; predicted)</li>
<li><strong>Zero residual</strong> (<span class="math inline">\(e_i = 0\)</span>): Perfect prediction (rare!)</li>
</ul>
<p><strong>Why they matter:</strong> If your model is good, residuals should look like random noise with no pattern. If you see patterns in residuals, your model is missing something systematic.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="08b42884" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Example data</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>y_observed <span class="op">=</span> np.array([<span class="fl">5.2</span>, <span class="fl">7.8</span>, <span class="fl">10.1</span>, <span class="fl">12.5</span>, <span class="fl">15.3</span>])</span>
<span id="cb2-5"><a href="#cb2-5"></a>y_predicted <span class="op">=</span> np.array([<span class="fl">5.0</span>, <span class="fl">8.0</span>, <span class="fl">11.0</span>, <span class="fl">14.0</span>, <span class="fl">17.0</span>])</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># Calculate residuals</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>residuals <span class="op">=</span> y_observed <span class="op">-</span> y_predicted</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="bu">print</span>(<span class="ss">f"Observed:  </span><span class="sc">{</span>y_observed<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="bu">print</span>(<span class="ss">f"Predicted: </span><span class="sc">{</span>y_predicted<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="bu">print</span>(<span class="ss">f"Residuals: </span><span class="sc">{</span>residuals<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="bu">print</span>(<span class="ss">f"Sum of residuals: </span><span class="sc">{</span>residuals<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.2f}</span><span class="ss">"</span>)  <span class="co"># Should be ~0 for good models</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Common Pitfalls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common Pitfalls
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Confusing residuals with errors</strong>: Residuals (<span class="math inline">\(e\)</span>) are <em>estimates</em> of errors (<span class="math inline">\(\epsilon\)</span>). We never see true errors.</li>
<li><strong>Forgetting the sign</strong>: <span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>, not the other way around!</li>
</ul>
</div>
</div>
<hr>
</section>
</section>
<section id="the-general-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="the-general-linear-model">The General Linear Model</h2>
<p>The GLM is the foundation for most statistical models you’ll encounter.</p>
<section id="glm-equation" class="level3">
<h3 class="anchored" data-anchor-id="glm-equation">The GLM Equation</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\epsilon} \sim N(\mathbf{0}, \sigma^2\mathbf{I})\)</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\mathbf{y}\)</span> = outcome vector (<span class="math inline">\(n \times 1\)</span>)</li>
<li><span class="math inline">\(\mathbf{X}\)</span> = design matrix (<span class="math inline">\(n \times (p+1)\)</span>, includes intercept column)</li>
<li><span class="math inline">\(\boldsymbol{\beta}\)</span> = coefficient vector (<span class="math inline">\((p+1) \times 1\)</span>)</li>
<li><span class="math inline">\(\boldsymbol{\epsilon}\)</span> = error vector (<span class="math inline">\(n \times 1\)</span>)</li>
<li><span class="math inline">\(\sigma^2\mathbf{I}\)</span> = errors are independent with constant variance</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This single equation encompasses:</p>
<ul>
<li>Simple regression (<span class="math inline">\(p = 1\)</span> predictor)</li>
<li>Multiple regression (<span class="math inline">\(p &gt; 1\)</span> predictors)</li>
<li>ANOVA (predictors are group indicators)</li>
<li>ANCOVA (mix of continuous and categorical)</li>
</ul>
<p><strong>Matrix multiplication</strong> <span class="math inline">\(\mathbf{X}\boldsymbol{\beta}\)</span> gives you predicted values for all observations at once. Each row of <span class="math inline">\(\mathbf{X}\)</span> represents one observation’s predictor values; multiplying by <span class="math inline">\(\boldsymbol{\beta}\)</span> gives that observation’s predicted outcome.</p>
<p><strong>The assumption</strong> <span class="math inline">\(\boldsymbol{\epsilon} \sim N(\mathbf{0}, \sigma^2\mathbf{I})\)</span> means:</p>
<ol type="1">
<li>Errors average to zero (no systematic bias)</li>
<li>All errors have the same variance (homoscedasticity)</li>
<li>Errors are uncorrelated with each other (independence)</li>
<li>Errors are normally distributed</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="91aabd9a" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># Example: y = 2 + 3*x with 5 observations</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>y <span class="op">=</span> np.array([<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">17</span>])  <span class="co"># outcomes</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># Design matrix: first column = 1s (intercept), second = x values</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>X <span class="op">=</span> np.array([</span>
<span id="cb3-8"><a href="#cb3-8"></a>    [<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb3-9"><a href="#cb3-9"></a>    [<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb3-10"><a href="#cb3-10"></a>    [<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb3-11"><a href="#cb3-11"></a>    [<span class="dv">1</span>, <span class="dv">4</span>],</span>
<span id="cb3-12"><a href="#cb3-12"></a>    [<span class="dv">1</span>, <span class="dv">5</span>]</span>
<span id="cb3-13"><a href="#cb3-13"></a>])</span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co"># Coefficients (if we knew them)</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>beta <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">3</span>])  <span class="co"># intercept=2, slope=3</span></span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co"># Matrix multiplication gives predictions</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>y_predicted <span class="op">=</span> X <span class="op">@</span> beta  <span class="co"># @ is matrix multiplication</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="bu">print</span>(<span class="ss">f"Predicted: </span><span class="sc">{</span>y_predicted<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="bu">print</span>(<span class="ss">f"Observed:  </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="design-matrix" class="level3">
<h3 class="anchored" data-anchor-id="design-matrix">Design Matrix Structure</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\mathbf{X} = \begin{bmatrix} 1 &amp; x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1p} \\ 1 &amp; x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2p} \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{np} \end{bmatrix}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The design matrix is how we encode our predictors for the model:</p>
<ul>
<li><strong>Rows</strong> = observations (one per participant/trial)</li>
<li><strong>Columns</strong> = predictors (first column is usually 1s for intercept)</li>
<li><strong>First column of 1s</strong> = allows us to estimate the intercept</li>
</ul>
<p>For <strong>categorical predictors</strong>, we use dummy coding (0s and 1s) or other contrast coding schemes instead of raw category labels.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="0fd538bf" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># From a DataFrame</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>df <span class="op">=</span> pl.DataFrame({</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="st">'y'</span>: [<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">17</span>],</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="st">'x1'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="st">'x2'</span>: [<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="fl">2.5</span>]</span>
<span id="cb4-9"><a href="#cb4-9"></a>})</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># Extract as numpy arrays</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>y <span class="op">=</span> df[<span class="st">'y'</span>].to_numpy()</span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co"># Create design matrix (add intercept column)</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>X <span class="op">=</span> np.column_stack([</span>
<span id="cb4-16"><a href="#cb4-16"></a>    np.ones(<span class="bu">len</span>(df)),           <span class="co"># intercept</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>    df[<span class="st">'x1'</span>].to_numpy(),        <span class="co"># predictor 1</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>    df[<span class="st">'x2'</span>].to_numpy()         <span class="co"># predictor 2</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>])</span>
<span id="cb4-20"><a href="#cb4-20"></a></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="bu">print</span>(<span class="st">"Design matrix X:"</span>)</span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="bu">print</span>(X)</span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Shape: </span><span class="sc">{</span>X<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)  <span class="co"># (n_observations, n_predictors+1)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="ols-estimator" class="level3">
<h3 class="anchored" data-anchor-id="ols-estimator">OLS Estimator</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> = estimated coefficients</li>
<li><span class="math inline">\(\mathbf{X}^T\)</span> = transpose of design matrix</li>
<li><span class="math inline">\((\mathbf{X}^T\mathbf{X})^{-1}\)</span> = inverse of <span class="math inline">\(\mathbf{X}^T\mathbf{X}\)</span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>OLS = <strong>Ordinary Least Squares</strong>. This formula finds the coefficients that minimize the sum of squared residuals.</p>
<p><strong>Where it comes from:</strong></p>
<ol type="1">
<li>We want to minimize: <span class="math inline">\(\sum_i (y_i - \hat{y}_i)^2 = (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^T(\mathbf{y} - \mathbf{X}\boldsymbol{\beta})\)</span></li>
<li>Take the derivative with respect to <span class="math inline">\(\boldsymbol{\beta}\)</span> and set to zero</li>
<li>Solve for <span class="math inline">\(\boldsymbol{\beta}\)</span>… and you get this formula!</li>
</ol>
<p><strong>Reading the formula:</strong></p>
<ul>
<li><span class="math inline">\(\mathbf{X}^T\mathbf{y}\)</span> = how much each predictor correlates with the outcome</li>
<li><span class="math inline">\((\mathbf{X}^T\mathbf{X})^{-1}\)</span> = adjusts for correlations among predictors</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="d3d6e1e3" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Example data</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>y <span class="op">=</span> np.array([<span class="fl">5.2</span>, <span class="fl">7.8</span>, <span class="fl">10.1</span>, <span class="fl">13.2</span>, <span class="fl">15.9</span>])</span>
<span id="cb5-5"><a href="#cb5-5"></a>X <span class="op">=</span> np.array([</span>
<span id="cb5-6"><a href="#cb5-6"></a>    [<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb5-7"><a href="#cb5-7"></a>    [<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb5-8"><a href="#cb5-8"></a>    [<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb5-9"><a href="#cb5-9"></a>    [<span class="dv">1</span>, <span class="dv">4</span>],</span>
<span id="cb5-10"><a href="#cb5-10"></a>    [<span class="dv">1</span>, <span class="dv">5</span>]</span>
<span id="cb5-11"><a href="#cb5-11"></a>])</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co"># OLS formula step by step</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>XtX <span class="op">=</span> X.T <span class="op">@</span> X                    <span class="co"># X'X</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>XtX_inv <span class="op">=</span> np.linalg.inv(XtX)     <span class="co"># (X'X)^(-1)</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>Xty <span class="op">=</span> X.T <span class="op">@</span> y                    <span class="co"># X'y</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>beta_hat <span class="op">=</span> XtX_inv <span class="op">@</span> Xty         <span class="co"># Final estimate</span></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="bu">print</span>(<span class="ss">f"Estimated coefficients: </span><span class="sc">{</span>beta_hat<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="bu">print</span>(<span class="ss">f"  Intercept: </span><span class="sc">{</span>beta_hat[<span class="dv">0</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="bu">print</span>(<span class="ss">f"  Slope: </span><span class="sc">{</span>beta_hat[<span class="dv">1</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb5-22"><a href="#cb5-22"></a></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co"># Verify with numpy's built-in (uses same math internally)</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>beta_numpy, residuals, rank, s <span class="op">=</span> np.linalg.lstsq(X, y, rcond<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">NumPy lstsq result: </span><span class="sc">{</span>beta_numpy<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Common Pitfalls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common Pitfalls
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Forgetting the intercept column</strong>: Your design matrix needs a column of 1s unless you’re centering predictors</li>
<li><strong>Singular matrix</strong>: If predictors are perfectly correlated, <span class="math inline">\(\mathbf{X}^T\mathbf{X}\)</span> can’t be inverted</li>
<li><strong>Order matters for matrix multiplication</strong>: <span class="math inline">\(\mathbf{X}^T\mathbf{X}\)</span> is different from <span class="math inline">\(\mathbf{X}\mathbf{X}^T\)</span></li>
</ul>
</div>
</div>
<p><strong>See also:</strong> <a href="#design-matrix">Design Matrix</a>, <a href="#variance-of-coefficients">Variance of Coefficients</a></p>
</section>
<section id="variance-of-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="variance-of-coefficients">Variance of Coefficients</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\text{Var}(\hat{\boldsymbol{\beta}}) = \sigma^2(\mathbf{X}^T\mathbf{X})^{-1}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This formula tells us how uncertain we are about our coefficient estimates.</p>
<p><strong>Key insights:</strong></p>
<ul>
<li>Larger <span class="math inline">\(\sigma^2\)</span> (more noise) → more uncertainty in coefficients</li>
<li><span class="math inline">\((\mathbf{X}^T\mathbf{X})^{-1}\)</span> depends on your predictor values:
<ul>
<li>More spread in <span class="math inline">\(X\)</span> → smaller variance (more precise estimates)</li>
<li>Correlated predictors → larger variance (less precise)</li>
<li>More observations → smaller variance</li>
</ul></li>
</ul>
<p><strong>The diagonal elements</strong> give variances for each coefficient; off-diagonal elements give covariances between coefficients.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="bd50e819" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># Continuing from OLS example</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># We need to estimate sigma^2 first (from residuals)</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>y <span class="op">=</span> np.array([<span class="fl">5.2</span>, <span class="fl">7.8</span>, <span class="fl">10.1</span>, <span class="fl">13.2</span>, <span class="fl">15.9</span>])</span>
<span id="cb6-6"><a href="#cb6-6"></a>X <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">3</span>], [<span class="dv">1</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">5</span>]])</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># Get beta_hat (from before)</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>beta_hat <span class="op">=</span> np.linalg.inv(X.T <span class="op">@</span> X) <span class="op">@</span> X.T <span class="op">@</span> y</span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co"># Calculate residuals and estimate sigma^2</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>y_hat <span class="op">=</span> X <span class="op">@</span> beta_hat</span>
<span id="cb6-13"><a href="#cb6-13"></a>residuals <span class="op">=</span> y <span class="op">-</span> y_hat</span>
<span id="cb6-14"><a href="#cb6-14"></a>n, p_plus_1 <span class="op">=</span> X.shape</span>
<span id="cb6-15"><a href="#cb6-15"></a>sigma2_hat <span class="op">=</span> np.<span class="bu">sum</span>(residuals<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (n <span class="op">-</span> p_plus_1)  <span class="co"># n - p - 1</span></span>
<span id="cb6-16"><a href="#cb6-16"></a></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co"># Variance-covariance matrix of coefficients</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>var_beta <span class="op">=</span> sigma2_hat <span class="op">*</span> np.linalg.inv(X.T <span class="op">@</span> X)</span>
<span id="cb6-19"><a href="#cb6-19"></a></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="bu">print</span>(<span class="st">"Variance-covariance matrix:"</span>)</span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="bu">print</span>(var_beta)</span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Variance of intercept: </span><span class="sc">{</span>var_beta[<span class="dv">0</span>,<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="bu">print</span>(<span class="ss">f"Variance of slope: </span><span class="sc">{</span>var_beta[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="standard-errors" class="level3">
<h3 class="anchored" data-anchor-id="standard-errors">Standard Errors</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[SE(\hat{\beta}_j) = \hat{\sigma}\sqrt{(\mathbf{X}^T\mathbf{X})^{-1}_{jj}}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(SE(\hat{\beta}_j)\)</span> = standard error of the <span class="math inline">\(j\)</span>th coefficient</li>
<li><span class="math inline">\(\hat{\sigma}\)</span> = estimated residual standard deviation</li>
<li><span class="math inline">\((\mathbf{X}^T\mathbf{X})^{-1}_{jj}\)</span> = the <span class="math inline">\(j\)</span>th diagonal element</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Standard errors are the <strong>square roots of the variances</strong>. They’re in the same units as the coefficients, making them easier to interpret.</p>
<p><strong>SE tells you:</strong> How much would <span class="math inline">\(\hat{\beta}_j\)</span> vary if you repeated the study many times?</p>
<p>A coefficient is typically “significant” if it’s more than ~2 SEs away from zero (this is the t-test!).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="ed673ae2" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># Continuing from variance example</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># var_beta already computed above</span></span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># Standard errors are square roots of diagonal</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>se_intercept <span class="op">=</span> np.sqrt(var_beta[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb7-8"><a href="#cb7-8"></a>se_slope <span class="op">=</span> np.sqrt(var_beta[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="bu">print</span>(<span class="ss">f"SE of intercept: </span><span class="sc">{</span>se_intercept<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="bu">print</span>(<span class="ss">f"SE of slope: </span><span class="sc">{</span>se_slope<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co"># Or get all SEs at once</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>se_all <span class="op">=</span> np.sqrt(np.diag(var_beta))</span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="bu">print</span>(<span class="ss">f"All SEs: </span><span class="sc">{</span>se_all<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="residual-variance" class="level3">
<h3 class="anchored" data-anchor-id="residual-variance">Residual Variance Estimate</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\hat{\sigma}^2 = \frac{\sum_i(y_i - \hat{y}_i)^2}{n - p - 1} = \frac{SSE}{n - p - 1}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\hat{\sigma}^2\)</span> = estimated error variance</li>
<li><span class="math inline">\(SSE\)</span> = sum of squared errors (residuals)</li>
<li><span class="math inline">\(n - p - 1\)</span> = degrees of freedom (residual df)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We divide by <span class="math inline">\(n - p - 1\)</span> (not <span class="math inline">\(n\)</span>) because we “used up” <span class="math inline">\(p + 1\)</span> degrees of freedom estimating the coefficients.</p>
<p><strong>Why <span class="math inline">\(n - p - 1\)</span>?</strong></p>
<ul>
<li><span class="math inline">\(n\)</span> = total observations</li>
<li><span class="math inline">\(p\)</span> = number of predictors</li>
<li><span class="math inline">\(1\)</span> = the intercept</li>
<li>Each coefficient we estimate “costs” one degree of freedom</li>
</ul>
<p>This correction makes <span class="math inline">\(\hat{\sigma}^2\)</span> an <strong>unbiased</strong> estimator of the true <span class="math inline">\(\sigma^2\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="78348731" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># Example</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>y <span class="op">=</span> np.array([<span class="fl">5.2</span>, <span class="fl">7.8</span>, <span class="fl">10.1</span>, <span class="fl">13.2</span>, <span class="fl">15.9</span>])</span>
<span id="cb8-5"><a href="#cb8-5"></a>X <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">3</span>], [<span class="dv">1</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">5</span>]])</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a>beta_hat <span class="op">=</span> np.linalg.inv(X.T <span class="op">@</span> X) <span class="op">@</span> X.T <span class="op">@</span> y</span>
<span id="cb8-8"><a href="#cb8-8"></a>y_hat <span class="op">=</span> X <span class="op">@</span> beta_hat</span>
<span id="cb8-9"><a href="#cb8-9"></a>residuals <span class="op">=</span> y <span class="op">-</span> y_hat</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a>n <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb8-12"><a href="#cb8-12"></a>p <span class="op">=</span> X.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>  <span class="co"># number of predictors (not counting intercept)</span></span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a>SSE <span class="op">=</span> np.<span class="bu">sum</span>(residuals<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb8-15"><a href="#cb8-15"></a>df_residual <span class="op">=</span> n <span class="op">-</span> p <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>sigma2_hat <span class="op">=</span> SSE <span class="op">/</span> df_residual</span>
<span id="cb8-17"><a href="#cb8-17"></a>sigma_hat <span class="op">=</span> np.sqrt(sigma2_hat)</span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="bu">print</span>(<span class="ss">f"SSE: </span><span class="sc">{</span>SSE<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="bu">print</span>(<span class="ss">f"Residual df: </span><span class="sc">{</span>df_residual<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="bu">print</span>(<span class="ss">f"Estimated variance (sigma^2): </span><span class="sc">{</span>sigma2_hat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="bu">print</span>(<span class="ss">f"Estimated SD (sigma): </span><span class="sc">{</span>sigma_hat<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Your Turn: OLS by Hand">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Your Turn: OLS by Hand
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given the following data, calculate the OLS estimates by hand (well, with numpy):</p>
<div id="31704690" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>y <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>])</span>
<span id="cb9-4"><a href="#cb9-4"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co"># 1. Create design matrix X (with intercept column)</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># 2. Calculate beta_hat using OLS formula</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co"># 3. Calculate residuals</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co"># 4. Calculate estimated sigma^2</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co"># 5. Calculate standard errors</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="30570861" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>y <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>])</span>
<span id="cb10-4"><a href="#cb10-4"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co"># 1. Design matrix</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>X <span class="op">=</span> np.column_stack([np.ones(<span class="dv">5</span>), x])</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="bu">print</span>(<span class="st">"Design matrix:</span><span class="ch">\n</span><span class="st">"</span>, X)</span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co"># 2. OLS estimates</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>beta_hat <span class="op">=</span> np.linalg.inv(X.T <span class="op">@</span> X) <span class="op">@</span> X.T <span class="op">@</span> y</span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Coefficients: intercept=</span><span class="sc">{</span>beta_hat[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">, slope=</span><span class="sc">{</span>beta_hat[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co"># 3. Residuals</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>y_hat <span class="op">=</span> X <span class="op">@</span> beta_hat</span>
<span id="cb10-16"><a href="#cb10-16"></a>residuals <span class="op">=</span> y <span class="op">-</span> y_hat</span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="bu">print</span>(<span class="ss">f"Residuals: </span><span class="sc">{</span>residuals<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-18"><a href="#cb10-18"></a></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co"># 4. Sigma^2</span></span>
<span id="cb10-20"><a href="#cb10-20"></a>n, p_plus_1 <span class="op">=</span> X.shape</span>
<span id="cb10-21"><a href="#cb10-21"></a>sigma2_hat <span class="op">=</span> np.<span class="bu">sum</span>(residuals<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (n <span class="op">-</span> p_plus_1)</span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="bu">print</span>(<span class="ss">f"Sigma^2: </span><span class="sc">{</span>sigma2_hat<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb10-23"><a href="#cb10-23"></a></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># 5. Standard errors</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>var_beta <span class="op">=</span> sigma2_hat <span class="op">*</span> np.linalg.inv(X.T <span class="op">@</span> X)</span>
<span id="cb10-26"><a href="#cb10-26"></a>se <span class="op">=</span> np.sqrt(np.diag(var_beta))</span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="bu">print</span>(<span class="ss">f"SE intercept: </span><span class="sc">{</span>se[<span class="dv">0</span>]<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="bu">print</span>(<span class="ss">f"SE slope: </span><span class="sc">{</span>se[<span class="dv">1</span>]<span class="sc">:.6f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="model-fit-and-comparison" class="level2">
<h2 class="anchored" data-anchor-id="model-fit-and-comparison">Model Fit and Comparison</h2>
<p>How do we know if our model is any good? These metrics help us evaluate and compare models.</p>
<section id="r-squared" class="level3">
<h3 class="anchored" data-anchor-id="r-squared">R-squared</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[R^2 = 1 - \frac{SS_{res}}{SS_{tot}} = 1 - \frac{\sum_i(y_i - \hat{y}_i)^2}{\sum_i(y_i - \bar{y})^2}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(SS_{res}\)</span> = residual sum of squares (unexplained variance)</li>
<li><span class="math inline">\(SS_{tot}\)</span> = total sum of squares (total variance)</li>
<li><span class="math inline">\(\bar{y}\)</span> = mean of <span class="math inline">\(y\)</span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(R^2\)</span> answers: <strong>What proportion of variance in <span class="math inline">\(y\)</span> does our model explain?</strong></p>
<ul>
<li><span class="math inline">\(R^2 = 0\)</span>: Model explains nothing (predictions = <span class="math inline">\(\bar{y}\)</span>)</li>
<li><span class="math inline">\(R^2 = 1\)</span>: Model explains everything (perfect prediction)</li>
<li><span class="math inline">\(R^2 = 0.5\)</span>: Model explains 50% of variance</li>
</ul>
<p><strong>Where it comes from:</strong> We partition total variance into explained + unexplained:</p>
<p><span class="math display">\[SS_{tot} = SS_{model} + SS_{res}\]</span></p>
<p>Then <span class="math inline">\(R^2 = SS_{model} / SS_{tot} = 1 - SS_{res} / SS_{tot}\)</span></p>
<p><strong>Important:</strong> <span class="math inline">\(R^2\)</span> always increases when you add predictors, even useless ones!</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="5a1c17a4" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>y <span class="op">=</span> np.array([<span class="fl">5.2</span>, <span class="fl">7.8</span>, <span class="fl">10.1</span>, <span class="fl">13.2</span>, <span class="fl">15.9</span>])</span>
<span id="cb11-4"><a href="#cb11-4"></a>y_hat <span class="op">=</span> np.array([<span class="fl">5.3</span>, <span class="fl">7.9</span>, <span class="fl">10.5</span>, <span class="fl">13.1</span>, <span class="fl">15.7</span>])</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co"># Calculate R-squared</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>y_bar <span class="op">=</span> np.mean(y)</span>
<span id="cb11-8"><a href="#cb11-8"></a>SS_tot <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_bar)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a>SS_res <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a>R2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> SS_res <span class="op">/</span> SS_tot</span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="bu">print</span>(<span class="ss">f"SS_total: </span><span class="sc">{</span>SS_tot<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="bu">print</span>(<span class="ss">f"SS_residual: </span><span class="sc">{</span>SS_res<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="bu">print</span>(<span class="ss">f"R-squared: </span><span class="sc">{</span>R2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="bu">print</span>(<span class="ss">f"Interpretation: Model explains </span><span class="sc">{</span>R2<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% of variance"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Common Pitfalls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common Pitfalls
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Thinking higher is always better</strong>: You can inflate <span class="math inline">\(R^2\)</span> by adding noise predictors</li>
<li><strong>Comparing across different outcomes</strong>: <span class="math inline">\(R^2\)</span> depends on variance in <span class="math inline">\(y\)</span></li>
<li><strong>Using with small samples</strong>: <span class="math inline">\(R^2\)</span> is biased upward in small samples</li>
</ul>
</div>
</div>
</section>
<section id="adjusted-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="adjusted-r-squared">Adjusted R-squared</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[R^2_{adj} = 1 - (1 - R^2)\frac{n - 1}{n - p - 1}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Adjusted <span class="math inline">\(R^2\)</span> <strong>penalizes</strong> for adding predictors. It can actually <em>decrease</em> if you add a useless predictor.</p>
<p><strong>The penalty term</strong> <span class="math inline">\(\frac{n-1}{n-p-1}\)</span> is always <span class="math inline">\(\geq 1\)</span> and gets larger as you add more predictors (<span class="math inline">\(p\)</span> increases).</p>
<p><strong>Use adjusted <span class="math inline">\(R^2\)</span> when:</strong> Comparing models with different numbers of predictors.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="7f445edd" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># Continuing from R-squared example</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>R2 <span class="op">=</span> <span class="fl">0.95</span>  <span class="co"># from previous calculation</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>n <span class="op">=</span> <span class="dv">5</span>      <span class="co"># observations</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>p <span class="op">=</span> <span class="dv">1</span>      <span class="co"># predictors (not counting intercept)</span></span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a>R2_adj <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span> <span class="op">-</span> R2) <span class="op">*</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (n <span class="op">-</span> p <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="bu">print</span>(<span class="ss">f"R-squared: </span><span class="sc">{</span>R2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="bu">print</span>(<span class="ss">f"Adjusted R-squared: </span><span class="sc">{</span>R2_adj<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co"># Compare with more predictors (same R2)</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>p2 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>R2_adj_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span> <span class="op">-</span> R2) <span class="op">*</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (n <span class="op">-</span> p2 <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">With </span><span class="sc">{</span>p2<span class="sc">}</span><span class="ss"> predictors (same R2): </span><span class="sc">{</span>R2_adj_2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="bu">print</span>(<span class="st">"Note: More predictors → lower adjusted R2 (if R2 doesn't improve much)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="f-statistic" class="level3">
<h3 class="anchored" data-anchor-id="f-statistic">F-statistic</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[F = \frac{(SS_{tot} - SS_{res})/p}{SS_{res}/(n-p-1)} = \frac{MS_{model}}{MS_{error}}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(MS_{model}\)</span> = mean square for model (explained variance / df)</li>
<li><span class="math inline">\(MS_{error}\)</span> = mean square for error (unexplained variance / df)</li>
<li><span class="math inline">\(p\)</span> = number of predictors</li>
<li><span class="math inline">\(n - p - 1\)</span> = residual degrees of freedom</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The F-statistic tests: <strong>Does the model explain more variance than expected by chance?</strong></p>
<p>It’s a ratio of two variances:</p>
<ul>
<li><strong>Numerator</strong>: How much variance does the model explain (per predictor)?</li>
<li><strong>Denominator</strong>: How much noise is left over (per residual df)?</li>
</ul>
<p>If the model is useful, the numerator should be much larger than the denominator, giving <span class="math inline">\(F &gt;&gt; 1\)</span>.</p>
<p><strong>Under the null hypothesis</strong> (model explains nothing), <span class="math inline">\(F \sim F(p, n-p-1)\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="5043df35" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>y <span class="op">=</span> np.array([<span class="fl">5.2</span>, <span class="fl">7.8</span>, <span class="fl">10.1</span>, <span class="fl">13.2</span>, <span class="fl">15.9</span>])</span>
<span id="cb13-5"><a href="#cb13-5"></a>y_hat <span class="op">=</span> np.array([<span class="fl">5.3</span>, <span class="fl">7.9</span>, <span class="fl">10.5</span>, <span class="fl">13.1</span>, <span class="fl">15.7</span>])</span>
<span id="cb13-6"><a href="#cb13-6"></a>y_bar <span class="op">=</span> np.mean(y)</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a>n <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb13-9"><a href="#cb13-9"></a>p <span class="op">=</span> <span class="dv">1</span>  <span class="co"># predictors</span></span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a>SS_tot <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_bar)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a>SS_res <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a>SS_model <span class="op">=</span> SS_tot <span class="op">-</span> SS_res</span>
<span id="cb13-14"><a href="#cb13-14"></a></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co"># Mean squares</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>MS_model <span class="op">=</span> SS_model <span class="op">/</span> p</span>
<span id="cb13-17"><a href="#cb13-17"></a>MS_error <span class="op">=</span> SS_res <span class="op">/</span> (n <span class="op">-</span> p <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co"># F-statistic</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>F <span class="op">=</span> MS_model <span class="op">/</span> MS_error</span>
<span id="cb13-21"><a href="#cb13-21"></a></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co"># p-value</span></span>
<span id="cb13-23"><a href="#cb13-23"></a>p_value <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.f.cdf(F, p, n <span class="op">-</span> p <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb13-24"><a href="#cb13-24"></a></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="bu">print</span>(<span class="ss">f"MS_model: </span><span class="sc">{</span>MS_model<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="bu">print</span>(<span class="ss">f"MS_error: </span><span class="sc">{</span>MS_error<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="bu">print</span>(<span class="ss">f"F-statistic: </span><span class="sc">{</span>F<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="likelihood-ratio-test" class="level3">
<h3 class="anchored" data-anchor-id="likelihood-ratio-test">Likelihood Ratio Test</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\chi^2 = -2(\log L_{reduced} - \log L_{full}) = -2 \log\left(\frac{L_{reduced}}{L_{full}}\right)\]</span></p>
<p>with <span class="math inline">\(df\)</span> = difference in number of parameters</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The LRT compares two <strong>nested models</strong> (the reduced model is a special case of the full model).</p>
<p><strong>Key insight:</strong> If the full model is much better, the likelihood ratio <span class="math inline">\(L_{reduced}/L_{full}\)</span> will be very small, making <span class="math inline">\(-2 \log(\cdot)\)</span> very large.</p>
<p><strong>When to use:</strong> Comparing models fit with maximum likelihood (logistic regression, mixed models, etc.) where F-tests don’t apply.</p>
<p>Under <span class="math inline">\(H_0\)</span> (reduced model is adequate), <span class="math inline">\(\chi^2 \sim \chi^2(df)\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cb664e4c" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># Example log-likelihoods (you'd get these from your fitted models)</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>logL_reduced <span class="op">=</span> <span class="op">-</span><span class="fl">45.2</span>  <span class="co"># simpler model</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>logL_full <span class="op">=</span> <span class="op">-</span><span class="fl">42.8</span>     <span class="co"># more complex model</span></span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co"># LRT statistic</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>chi2 <span class="op">=</span> <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> (logL_reduced <span class="op">-</span> logL_full)</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># Degrees of freedom = difference in parameters</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>df <span class="op">=</span> <span class="dv">2</span>  <span class="co"># full model has 2 more parameters</span></span>
<span id="cb14-12"><a href="#cb14-12"></a></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co"># p-value</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>p_value <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.chi2.cdf(chi2, df)</span>
<span id="cb14-15"><a href="#cb14-15"></a></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="bu">print</span>(<span class="ss">f"Log-likelihood (reduced): </span><span class="sc">{</span>logL_reduced<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="bu">print</span>(<span class="ss">f"Log-likelihood (full): </span><span class="sc">{</span>logL_full<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="bu">print</span>(<span class="ss">f"Chi-squared statistic: </span><span class="sc">{</span>chi2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="bu">print</span>(<span class="ss">f"Degrees of freedom: </span><span class="sc">{</span>df<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="inference-and-uncertainty" class="level2">
<h2 class="anchored" data-anchor-id="inference-and-uncertainty">Inference and Uncertainty</h2>
<p>How do we quantify uncertainty and test hypotheses about our estimates?</p>
<section id="t-statistic" class="level3">
<h3 class="anchored" data-anchor-id="t-statistic">t-statistic for Coefficients</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[t = \frac{\hat{\beta}_j - \beta_{0}}{SE(\hat{\beta}_j)}\]</span></p>
<p>Typically testing <span class="math inline">\(\beta_0 = 0\)</span>:</p>
<p><span class="math display">\[t = \frac{\hat{\beta}_j}{SE(\hat{\beta}_j)}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The t-statistic measures <strong>how many standard errors the estimate is from the null value</strong>.</p>
<ul>
<li><span class="math inline">\(|t| &gt; 2\)</span> roughly corresponds to <span class="math inline">\(p &lt; 0.05\)</span> (for reasonable <span class="math inline">\(df\)</span>)</li>
<li>Larger <span class="math inline">\(|t|\)</span> = stronger evidence against the null</li>
</ul>
<p><strong>Why it works:</strong> If <span class="math inline">\(H_0\)</span> is true and assumptions hold, <span class="math inline">\(t \sim t(n - p - 1)\)</span>.</p>
<p><strong>Relationship to confidence intervals:</strong> If the 95% CI doesn’t include 0, then <span class="math inline">\(|t| &gt; t_{crit}\)</span> and <span class="math inline">\(p &lt; 0.05\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="2a094ff2" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># Example</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>beta_hat <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>se_beta <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>n <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>p <span class="op">=</span> <span class="dv">2</span>  <span class="co"># predictors</span></span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co"># t-statistic (testing beta = 0)</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>t_stat <span class="op">=</span> beta_hat <span class="op">/</span> se_beta</span>
<span id="cb15-12"><a href="#cb15-12"></a>df <span class="op">=</span> n <span class="op">-</span> p <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb15-13"><a href="#cb15-13"></a></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co"># Two-tailed p-value</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>p_value <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat), df))</span>
<span id="cb15-16"><a href="#cb15-16"></a></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="bu">print</span>(<span class="ss">f"Coefficient: </span><span class="sc">{</span>beta_hat<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="bu">print</span>(<span class="ss">f"SE: </span><span class="sc">{</span>se_beta<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_stat<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="bu">print</span>(<span class="ss">f"df: </span><span class="sc">{</span>df<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\hat{\beta}_j \pm t_{\alpha/2, n-p-1} \cdot SE(\hat{\beta}_j)\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(t_{\alpha/2, n-p-1}\)</span> = critical t-value for desired confidence level</li>
<li>For 95% CI: <span class="math inline">\(\alpha = 0.05\)</span>, so we use <span class="math inline">\(t_{0.025, df}\)</span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-47-contents" aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-47" class="callout-47-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A 95% CI means: <strong>If we repeated this study many times, 95% of the intervals would contain the true <span class="math inline">\(\beta\)</span>.</strong></p>
<p>It does NOT mean: “There’s a 95% probability the true value is in this interval.” (The true value either is or isn’t in the interval—we just don’t know which.)</p>
<p><strong>Interpretation tip:</strong> The width of the CI reflects uncertainty. Wider CI = more uncertain.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="c3e0500a" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a>beta_hat <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>se_beta <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>n <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>p <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>df <span class="op">=</span> n <span class="op">-</span> p <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>confidence <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb16-10"><a href="#cb16-10"></a></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co"># Critical t-value</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>t_crit <span class="op">=</span> stats.t.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>, df)</span>
<span id="cb16-13"><a href="#cb16-13"></a></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co"># Confidence interval</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>ci_lower <span class="op">=</span> beta_hat <span class="op">-</span> t_crit <span class="op">*</span> se_beta</span>
<span id="cb16-16"><a href="#cb16-16"></a>ci_upper <span class="op">=</span> beta_hat <span class="op">+</span> t_crit <span class="op">*</span> se_beta</span>
<span id="cb16-17"><a href="#cb16-17"></a></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="bu">print</span>(<span class="ss">f"Coefficient: </span><span class="sc">{</span>beta_hat<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="bu">print</span>(<span class="ss">f"SE: </span><span class="sc">{</span>se_beta<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="bu">print</span>(<span class="ss">f"t critical (95%): </span><span class="sc">{</span>t_crit<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="bu">print</span>(<span class="ss">f"95% CI: [</span><span class="sc">{</span>ci_lower<span class="sc">:.3f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">:.3f}</span><span class="ss">]"</span>)</span>
<span id="cb16-22"><a href="#cb16-22"></a></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co"># Check if CI excludes 0</span></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="cf">if</span> ci_lower <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">or</span> ci_upper <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb16-25"><a href="#cb16-25"></a>    <span class="bu">print</span>(<span class="st">"CI excludes 0 → significant at alpha = 0.05"</span>)</span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="cf">else</span>:</span>
<span id="cb16-27"><a href="#cb16-27"></a>    <span class="bu">print</span>(<span class="st">"CI includes 0 → not significant at alpha = 0.05"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Common Pitfalls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common Pitfalls
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Using z instead of t</strong>: For small samples, you need the t-distribution</li>
<li><strong>Forgetting it’s two-tailed</strong>: For 95% CI, use <span class="math inline">\(t_{0.025}\)</span>, not <span class="math inline">\(t_{0.05}\)</span></li>
<li><strong>Misinterpreting</strong>: It’s about the procedure, not probability of the interval</li>
</ul>
</div>
</div>
</section>
<section id="standard-error-mean" class="level3">
<h3 class="anchored" data-anchor-id="standard-error-mean">Standard Error of the Mean</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[SE(\bar{x}) = \frac{s}{\sqrt{n}}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(s\)</span> = sample standard deviation</li>
<li><span class="math inline">\(n\)</span> = sample size</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-51-contents" aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-51" class="callout-51-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The SE of the mean tells you: <strong>How much would the sample mean vary across repeated samples?</strong></p>
<p>Key insights:</p>
<ul>
<li>Larger <span class="math inline">\(n\)</span> → smaller SE (more precise estimate)</li>
<li>SE decreases with <span class="math inline">\(\sqrt{n}\)</span>, so you need 4x the sample size to halve the SE</li>
<li>This is different from <span class="math inline">\(s\)</span> (which describes spread of individual observations)</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-52-contents" aria-controls="callout-52" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-52" class="callout-52-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="0858aa0e" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a>data <span class="op">=</span> np.array([<span class="dv">245</span>, <span class="dv">312</span>, <span class="dv">289</span>, <span class="dv">267</span>, <span class="dv">301</span>, <span class="dv">278</span>, <span class="dv">295</span>])</span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co"># Manual calculation</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>n <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb17-8"><a href="#cb17-8"></a>sample_mean <span class="op">=</span> np.mean(data)</span>
<span id="cb17-9"><a href="#cb17-9"></a>sample_sd <span class="op">=</span> np.std(data, ddof<span class="op">=</span><span class="dv">1</span>)  <span class="co"># ddof=1 for sample SD</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>se_mean <span class="op">=</span> sample_sd <span class="op">/</span> np.sqrt(n)</span>
<span id="cb17-11"><a href="#cb17-11"></a></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="bu">print</span>(<span class="ss">f"Sample mean: </span><span class="sc">{</span>sample_mean<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="bu">print</span>(<span class="ss">f"Sample SD: </span><span class="sc">{</span>sample_sd<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="bu">print</span>(<span class="ss">f"SE of mean: </span><span class="sc">{</span>se_mean<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb17-15"><a href="#cb17-15"></a></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co"># Using scipy (same result)</span></span>
<span id="cb17-17"><a href="#cb17-17"></a>se_scipy <span class="op">=</span> stats.sem(data)</span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="bu">print</span>(<span class="ss">f"scipy.stats.sem: </span><span class="sc">{</span>se_scipy<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Your Turn: Confidence Interval">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Your Turn: Confidence Interval
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given reaction time data from 10 participants with mean = 285ms and SD = 45ms:</p>
<ol type="1">
<li>Calculate the SE of the mean</li>
<li>Calculate the 95% CI for the mean</li>
<li>Calculate the 99% CI for the mean</li>
</ol>
<p>Which interval is wider? Why?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-54-contents" aria-controls="callout-54" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-54" class="callout-54-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="e98985ca" class="cell" data-execution_count="19">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a>mean_rt <span class="op">=</span> <span class="dv">285</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>sd_rt <span class="op">=</span> <span class="dv">45</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co"># 1. SE of mean</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>se <span class="op">=</span> sd_rt <span class="op">/</span> np.sqrt(n)</span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="bu">print</span>(<span class="ss">f"SE of mean: </span><span class="sc">{</span>se<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb18-11"><a href="#cb18-11"></a></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co"># 2. 95% CI</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>df <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb18-14"><a href="#cb18-14"></a>t_95 <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, df)</span>
<span id="cb18-15"><a href="#cb18-15"></a>ci_95 <span class="op">=</span> (mean_rt <span class="op">-</span> t_95 <span class="op">*</span> se, mean_rt <span class="op">+</span> t_95 <span class="op">*</span> se)</span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="bu">print</span>(<span class="ss">f"95% CI: [</span><span class="sc">{</span>ci_95[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>ci_95[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">]"</span>)</span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="bu">print</span>(<span class="ss">f"  Width: </span><span class="sc">{</span>ci_95[<span class="dv">1</span>] <span class="op">-</span> ci_95[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb18-18"><a href="#cb18-18"></a></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co"># 3. 99% CI</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>t_99 <span class="op">=</span> stats.t.ppf(<span class="fl">0.995</span>, df)</span>
<span id="cb18-21"><a href="#cb18-21"></a>ci_99 <span class="op">=</span> (mean_rt <span class="op">-</span> t_99 <span class="op">*</span> se, mean_rt <span class="op">+</span> t_99 <span class="op">*</span> se)</span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="bu">print</span>(<span class="ss">f"99% CI: [</span><span class="sc">{</span>ci_99[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>ci_99[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">]"</span>)</span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="bu">print</span>(<span class="ss">f"  Width: </span><span class="sc">{</span>ci_99[<span class="dv">1</span>] <span class="op">-</span> ci_99[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb18-24"><a href="#cb18-24"></a></span>
<span id="cb18-25"><a href="#cb18-25"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">99% CI is wider because higher confidence requires a larger interval!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="different-outcome-types" class="level2">
<h2 class="anchored" data-anchor-id="different-outcome-types">Different Outcome Types</h2>
<p>When your outcome isn’t continuous, you need different models.</p>
<section id="logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression">Logistic Regression Model</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Logit form:</strong> <span class="math display">\[\log\left(\frac{p}{1-p}\right) = \mathbf{x}^T\boldsymbol{\beta}\]</span></p>
<p><strong>Probability form:</strong> <span class="math display">\[p = \frac{1}{1 + e^{-\mathbf{x}^T\boldsymbol{\beta}}}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(p\)</span> = probability of the outcome (e.g., success, “yes”)</li>
<li><span class="math inline">\(\frac{p}{1-p}\)</span> = odds</li>
<li><span class="math inline">\(\log\left(\frac{p}{1-p}\right)\)</span> = log-odds (logit)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-56-contents" aria-controls="callout-56" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-56" class="callout-56-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Logistic regression models <strong>binary outcomes</strong> (0/1, yes/no, success/failure).</p>
<p><strong>Why log-odds?</strong></p>
<ul>
<li>Probabilities are bounded (0 to 1)</li>
<li>The linear predictor (<span class="math inline">\(\mathbf{x}^T\boldsymbol{\beta}\)</span>) can be any real number</li>
<li>Log-odds transforms probabilities to an unbounded scale</li>
</ul>
<p><strong>The sigmoid function</strong> <span class="math inline">\(\frac{1}{1 + e^{-x}}\)</span> squashes any real number back to (0, 1).</p>
<p><strong>Coefficients mean:</strong> A 1-unit increase in <span class="math inline">\(x_j\)</span> changes the log-odds by <span class="math inline">\(\beta_j\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-57-contents" aria-controls="callout-57" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-57" class="callout-57-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fc111697" class="cell" data-execution_count="20">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw">def</span> logistic(x):</span>
<span id="cb19-4"><a href="#cb19-4"></a>    <span class="co">"""Sigmoid/logistic function: converts log-odds to probability"""</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>x))</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="kw">def</span> logit(p):</span>
<span id="cb19-8"><a href="#cb19-8"></a>    <span class="co">"""Logit function: converts probability to log-odds"""</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>    <span class="cf">return</span> np.log(p <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> p))</span>
<span id="cb19-10"><a href="#cb19-10"></a></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co"># Example: predict probability from coefficients</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>intercept <span class="op">=</span> <span class="op">-</span><span class="dv">2</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>beta_x <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>x_values <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>])</span>
<span id="cb19-15"><a href="#cb19-15"></a></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co"># Calculate log-odds and probabilities</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>log_odds <span class="op">=</span> intercept <span class="op">+</span> beta_x <span class="op">*</span> x_values</span>
<span id="cb19-18"><a href="#cb19-18"></a>probabilities <span class="op">=</span> logistic(log_odds)</span>
<span id="cb19-19"><a href="#cb19-19"></a></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="bu">print</span>(<span class="st">"x</span><span class="ch">\t</span><span class="st">log-odds</span><span class="ch">\t</span><span class="st">probability"</span>)</span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="cf">for</span> x, lo, p <span class="kw">in</span> <span class="bu">zip</span>(x_values, log_odds, probabilities):</span>
<span id="cb19-22"><a href="#cb19-22"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>lo<span class="sc">:.2f}</span><span class="ch">\t\t</span><span class="sc">{</span>p<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="odds-ratio" class="level3">
<h3 class="anchored" data-anchor-id="odds-ratio">Odds Ratio</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[OR = e^{\beta_j}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-59-contents" aria-controls="callout-59" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-59" class="callout-59-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The odds ratio is the <strong>multiplicative change in odds</strong> for a 1-unit increase in <span class="math inline">\(x_j\)</span>.</p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><span class="math inline">\(OR = 1\)</span>: No effect (odds unchanged)</li>
<li><span class="math inline">\(OR &gt; 1\)</span>: Increased odds (e.g., <span class="math inline">\(OR = 2\)</span> means odds double)</li>
<li><span class="math inline">\(OR &lt; 1\)</span>: Decreased odds (e.g., <span class="math inline">\(OR = 0.5\)</span> means odds halve)</li>
</ul>
<p><strong>Example:</strong> If <span class="math inline">\(\beta = 0.693\)</span> and <span class="math inline">\(OR = e^{0.693} = 2\)</span>, then a 1-unit increase in <span class="math inline">\(x\)</span> doubles the odds of the outcome.</p>
<p><strong>Why exponentiate?</strong> Because <span class="math inline">\(\beta\)</span> is on the log-odds scale; <span class="math inline">\(e^\beta\)</span> converts to the odds scale.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-60-contents" aria-controls="callout-60" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-60" class="callout-60-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="961e3f36" class="cell" data-execution_count="21">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co"># Example logistic regression coefficient</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>beta <span class="op">=</span> <span class="fl">0.693</span></span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co"># Convert to odds ratio</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>OR <span class="op">=</span> np.exp(beta)</span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="bu">print</span>(<span class="ss">f"Beta coefficient: </span><span class="sc">{</span>beta<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="bu">print</span>(<span class="ss">f"Odds Ratio: </span><span class="sc">{</span>OR<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co"># Interpretation</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="cf">if</span> OR <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb20-13"><a href="#cb20-13"></a>    <span class="bu">print</span>(<span class="ss">f"A 1-unit increase in x multiplies odds by </span><span class="sc">{</span>OR<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="cf">elif</span> OR <span class="op">&lt;</span> <span class="dv">1</span>:</span>
<span id="cb20-15"><a href="#cb20-15"></a>    <span class="bu">print</span>(<span class="ss">f"A 1-unit increase in x multiplies odds by </span><span class="sc">{</span>OR<span class="sc">:.2f}</span><span class="ss"> (reduces odds)"</span>)</span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="cf">else</span>:</span>
<span id="cb20-17"><a href="#cb20-17"></a>    <span class="bu">print</span>(<span class="st">"No effect on odds"</span>)</span>
<span id="cb20-18"><a href="#cb20-18"></a></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="co"># For a range of betas</span></span>
<span id="cb20-20"><a href="#cb20-20"></a>betas <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>])</span>
<span id="cb20-21"><a href="#cb20-21"></a>ORs <span class="op">=</span> np.exp(betas)</span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Beta</span><span class="ch">\t</span><span class="st">Odds Ratio"</span>)</span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="cf">for</span> b, o <span class="kw">in</span> <span class="bu">zip</span>(betas, ORs):</span>
<span id="cb20-24"><a href="#cb20-24"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>b<span class="sc">:.1f}</span><span class="ch">\t</span><span class="sc">{</span>o<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Common Pitfalls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common Pitfalls
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Confusing OR with probability</strong>: <span class="math inline">\(OR = 2\)</span> does NOT mean probability doubles</li>
<li><strong>Forgetting to exponentiate</strong>: Raw coefficients are log-odds, not odds ratios</li>
<li><strong>Assuming symmetry</strong>: <span class="math inline">\(OR = 2\)</span> (odds double) is not the same magnitude as <span class="math inline">\(OR = 0.5\)</span> (odds halve)</li>
</ul>
</div>
</div>
<hr>
</section>
</section>
<section id="resampling-methods" class="level2">
<h2 class="anchored" data-anchor-id="resampling-methods">Resampling Methods</h2>
<p>When parametric assumptions are questionable, resampling provides distribution-free inference.</p>
<section id="bootstrap-ci" class="level3">
<h3 class="anchored" data-anchor-id="bootstrap-ci">Bootstrap Percentile CI</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[CI_{1-\alpha} = [Q_{\alpha/2}(\hat{\theta}^*), Q_{1-\alpha/2}(\hat{\theta}^*)]\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\hat{\theta}^*\)</span> = bootstrap distribution of the statistic</li>
<li><span class="math inline">\(Q_p(\cdot)\)</span> = the <span class="math inline">\(p\)</span>th percentile</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-63-contents" aria-controls="callout-63" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-63" class="callout-63-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The bootstrap creates a <strong>sampling distribution by resampling your data</strong>.</p>
<p><strong>The procedure:</strong></p>
<ol type="1">
<li>Resample <span class="math inline">\(n\)</span> observations <strong>with replacement</strong> from your data</li>
<li>Calculate your statistic on the resample</li>
<li>Repeat many times (e.g., 10,000)</li>
<li>Use percentiles of the bootstrap distribution as CI bounds</li>
</ol>
<p><strong>Why it works:</strong> The variability in bootstrap samples mimics the variability you’d see if you could actually repeat the study.</p>
<p><strong>When to use:</strong> When you’re unsure about parametric assumptions, or for statistics without easy formulas (e.g., median, correlation).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-64-contents" aria-controls="callout-64" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-64" class="callout-64-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="ea962e4f" class="cell" data-execution_count="22">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co"># Original data</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>data <span class="op">=</span> np.array([<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">16</span>])</span>
<span id="cb21-8"><a href="#cb21-8"></a></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co"># Bootstrap parameters</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>n_bootstrap <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>n <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb21-12"><a href="#cb21-12"></a></span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="co"># Bootstrap resampling</span></span>
<span id="cb21-14"><a href="#cb21-14"></a>bootstrap_means <span class="op">=</span> np.zeros(n_bootstrap)</span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_bootstrap):</span>
<span id="cb21-16"><a href="#cb21-16"></a>    <span class="co"># Resample with replacement</span></span>
<span id="cb21-17"><a href="#cb21-17"></a>    resample <span class="op">=</span> np.random.choice(data, size<span class="op">=</span>n, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-18"><a href="#cb21-18"></a>    bootstrap_means[i] <span class="op">=</span> np.mean(resample)</span>
<span id="cb21-19"><a href="#cb21-19"></a></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="co"># Percentile CI</span></span>
<span id="cb21-21"><a href="#cb21-21"></a>ci_lower <span class="op">=</span> np.percentile(bootstrap_means, <span class="fl">2.5</span>)</span>
<span id="cb21-22"><a href="#cb21-22"></a>ci_upper <span class="op">=</span> np.percentile(bootstrap_means, <span class="fl">97.5</span>)</span>
<span id="cb21-23"><a href="#cb21-23"></a></span>
<span id="cb21-24"><a href="#cb21-24"></a><span class="bu">print</span>(<span class="ss">f"Original mean: </span><span class="sc">{</span>np<span class="sc">.</span>mean(data)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb21-25"><a href="#cb21-25"></a><span class="bu">print</span>(<span class="ss">f"Bootstrap SE: </span><span class="sc">{</span>np<span class="sc">.</span>std(bootstrap_means)<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-26"><a href="#cb21-26"></a><span class="bu">print</span>(<span class="ss">f"95% Bootstrap CI: [</span><span class="sc">{</span>ci_lower<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">:.2f}</span><span class="ss">]"</span>)</span>
<span id="cb21-27"><a href="#cb21-27"></a></span>
<span id="cb21-28"><a href="#cb21-28"></a><span class="co"># Compare to parametric CI</span></span>
<span id="cb21-29"><a href="#cb21-29"></a>se <span class="op">=</span> stats.sem(data)</span>
<span id="cb21-30"><a href="#cb21-30"></a>t_crit <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb21-31"><a href="#cb21-31"></a>ci_param <span class="op">=</span> (np.mean(data) <span class="op">-</span> t_crit<span class="op">*</span>se, np.mean(data) <span class="op">+</span> t_crit<span class="op">*</span>se)</span>
<span id="cb21-32"><a href="#cb21-32"></a><span class="bu">print</span>(<span class="ss">f"95% Parametric CI: [</span><span class="sc">{</span>ci_param[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>ci_param[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">]"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Common Pitfalls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common Pitfalls
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Too few bootstrap samples</strong>: Use at least 1,000; 10,000 is better</li>
<li><strong>Forgetting “with replacement”</strong>: This is essential for bootstrap</li>
<li><strong>Small original sample</strong>: Bootstrap can’t create information that isn’t there</li>
</ul>
</div>
</div>
</section>
<section id="power" class="level3">
<h3 class="anchored" data-anchor-id="power">Power</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\text{Power} = P(\text{reject } H_0 \mid H_1 \text{ is true}) = 1 - \beta\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\beta\)</span> = probability of Type II error (false negative)</li>
<li>Power = probability of detecting a true effect</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-67-contents" aria-controls="callout-67" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-67" class="callout-67-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Power answers: <strong>If there’s a real effect, what’s the chance we’ll find it?</strong></p>
<p><strong>Factors that increase power:</strong></p>
<ul>
<li>Larger sample size (<span class="math inline">\(n\)</span>)</li>
<li>Larger effect size (bigger true difference)</li>
<li>Smaller variability (<span class="math inline">\(\sigma\)</span>)</li>
<li>Higher <span class="math inline">\(\alpha\)</span> level (but increases false positives)</li>
</ul>
<p><strong>Convention:</strong> We typically want power <span class="math inline">\(\geq 0.80\)</span> (80% chance of detecting a true effect).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-68-contents" aria-controls="callout-68" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-68" class="callout-68-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="4c85961f" class="cell" data-execution_count="23">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># Power analysis for one-sample t-test</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co"># Testing if mean differs from 0</span></span>
<span id="cb22-6"><a href="#cb22-6"></a></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="kw">def</span> power_one_sample_t(n, effect_size, alpha<span class="op">=</span><span class="fl">0.05</span>):</span>
<span id="cb22-8"><a href="#cb22-8"></a>    <span class="co">"""</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">    Calculate power for one-sample t-test.</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">    effect_size = (true_mean - null_mean) / sd (Cohen's d)</span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">    """</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>    df <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>    t_crit <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, df)  <span class="co"># two-tailed</span></span>
<span id="cb22-14"><a href="#cb22-14"></a></span>
<span id="cb22-15"><a href="#cb22-15"></a>    <span class="co"># Non-central t-distribution parameter</span></span>
<span id="cb22-16"><a href="#cb22-16"></a>    ncp <span class="op">=</span> effect_size <span class="op">*</span> np.sqrt(n)</span>
<span id="cb22-17"><a href="#cb22-17"></a></span>
<span id="cb22-18"><a href="#cb22-18"></a>    <span class="co"># Power = P(|t| &gt; t_crit | H1 true)</span></span>
<span id="cb22-19"><a href="#cb22-19"></a>    power <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.nct.cdf(t_crit, df, ncp) <span class="op">+</span> stats.nct.cdf(<span class="op">-</span>t_crit, df, ncp)</span>
<span id="cb22-20"><a href="#cb22-20"></a>    <span class="cf">return</span> power</span>
<span id="cb22-21"><a href="#cb22-21"></a></span>
<span id="cb22-22"><a href="#cb22-22"></a><span class="co"># Example: medium effect size (d = 0.5)</span></span>
<span id="cb22-23"><a href="#cb22-23"></a>effect_size <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb22-24"><a href="#cb22-24"></a></span>
<span id="cb22-25"><a href="#cb22-25"></a><span class="bu">print</span>(<span class="st">"Sample Size</span><span class="ch">\t</span><span class="st">Power"</span>)</span>
<span id="cb22-26"><a href="#cb22-26"></a><span class="cf">for</span> n <span class="kw">in</span> [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>]:</span>
<span id="cb22-27"><a href="#cb22-27"></a>    pwr <span class="op">=</span> power_one_sample_t(n, effect_size)</span>
<span id="cb22-28"><a href="#cb22-28"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>n<span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>pwr<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb22-29"><a href="#cb22-29"></a></span>
<span id="cb22-30"><a href="#cb22-30"></a><span class="co"># Find sample size for 80% power</span></span>
<span id="cb22-31"><a href="#cb22-31"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Searching for n to achieve 80% power..."</span>)</span>
<span id="cb22-32"><a href="#cb22-32"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>, <span class="dv">200</span>):</span>
<span id="cb22-33"><a href="#cb22-33"></a>    <span class="cf">if</span> power_one_sample_t(n, effect_size) <span class="op">&gt;=</span> <span class="fl">0.80</span>:</span>
<span id="cb22-34"><a href="#cb22-34"></a>        <span class="bu">print</span>(<span class="ss">f"Need n = </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss"> for 80% power with d = </span><span class="sc">{</span>effect_size<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-35"><a href="#cb22-35"></a>        <span class="cf">break</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Your Turn: Bootstrap">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Your Turn: Bootstrap
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use the bootstrap to estimate the 95% CI for the <strong>median</strong> reaction time:</p>
<div id="818b2190" class="cell" data-execution_count="24">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-2"><a href="#cb23-2"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a>rt_data <span class="op">=</span> np.array([<span class="dv">245</span>, <span class="dv">312</span>, <span class="dv">289</span>, <span class="dv">267</span>, <span class="dv">301</span>, <span class="dv">278</span>, <span class="dv">295</span>, <span class="dv">310</span>, <span class="dv">256</span>, <span class="dv">288</span>])</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co"># 1. Calculate the sample median</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># 2. Generate 10,000 bootstrap samples</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co"># 3. Calculate median for each bootstrap sample</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co"># 4. Find the 2.5th and 97.5th percentiles</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-70-contents" aria-controls="callout-70" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-70" class="callout-70-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="b7be0689" class="cell" data-execution_count="25">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-2"><a href="#cb24-2"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a></span>
<span id="cb24-4"><a href="#cb24-4"></a>rt_data <span class="op">=</span> np.array([<span class="dv">245</span>, <span class="dv">312</span>, <span class="dv">289</span>, <span class="dv">267</span>, <span class="dv">301</span>, <span class="dv">278</span>, <span class="dv">295</span>, <span class="dv">310</span>, <span class="dv">256</span>, <span class="dv">288</span>])</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co"># 1. Sample median</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>sample_median <span class="op">=</span> np.median(rt_data)</span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="bu">print</span>(<span class="ss">f"Sample median: </span><span class="sc">{</span>sample_median<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co"># 2-3. Bootstrap</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>n_bootstrap <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>n <span class="op">=</span> <span class="bu">len</span>(rt_data)</span>
<span id="cb24-13"><a href="#cb24-13"></a>bootstrap_medians <span class="op">=</span> np.zeros(n_bootstrap)</span>
<span id="cb24-14"><a href="#cb24-14"></a></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_bootstrap):</span>
<span id="cb24-16"><a href="#cb24-16"></a>    resample <span class="op">=</span> np.random.choice(rt_data, size<span class="op">=</span>n, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-17"><a href="#cb24-17"></a>    bootstrap_medians[i] <span class="op">=</span> np.median(resample)</span>
<span id="cb24-18"><a href="#cb24-18"></a></span>
<span id="cb24-19"><a href="#cb24-19"></a><span class="co"># 4. Percentile CI</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>ci_lower <span class="op">=</span> np.percentile(bootstrap_medians, <span class="fl">2.5</span>)</span>
<span id="cb24-21"><a href="#cb24-21"></a>ci_upper <span class="op">=</span> np.percentile(bootstrap_medians, <span class="fl">97.5</span>)</span>
<span id="cb24-22"><a href="#cb24-22"></a></span>
<span id="cb24-23"><a href="#cb24-23"></a><span class="bu">print</span>(<span class="ss">f"Bootstrap SE: </span><span class="sc">{</span>np<span class="sc">.</span>std(bootstrap_medians)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb24-24"><a href="#cb24-24"></a><span class="bu">print</span>(<span class="ss">f"95% CI for median: [</span><span class="sc">{</span>ci_lower<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">}</span><span class="ss">]"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="mixed-models" class="level2">
<h2 class="anchored" data-anchor-id="mixed-models">Mixed Models</h2>
<p>When observations are clustered (repeated measures, hierarchical data), mixed models account for non-independence.</p>
<section id="random-intercept" class="level3">
<h3 class="anchored" data-anchor-id="random-intercept">Random Intercept Model</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[y_{ij} = \beta_0 + u_{0j} + \beta_1 x_{ij} + \epsilon_{ij}\]</span></p>
<p>where: <span class="math display">\[u_{0j} \sim N(0, \tau^2)\]</span> <span class="math display">\[\epsilon_{ij} \sim N(0, \sigma^2)\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(y_{ij}\)</span> = outcome for observation <span class="math inline">\(i\)</span> in group <span class="math inline">\(j\)</span></li>
<li><span class="math inline">\(\beta_0\)</span> = fixed intercept (grand mean)</li>
<li><span class="math inline">\(u_{0j}\)</span> = random intercept for group <span class="math inline">\(j\)</span> (deviation from grand mean)</li>
<li><span class="math inline">\(\beta_1\)</span> = fixed effect of <span class="math inline">\(x\)</span></li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> = residual error</li>
<li><span class="math inline">\(\tau^2\)</span> = between-group variance</li>
<li><span class="math inline">\(\sigma^2\)</span> = within-group variance</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-72-contents" aria-controls="callout-72" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-72" class="callout-72-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A random intercept model allows <strong>each group to have its own baseline</strong> while sharing a common slope.</p>
<p><strong>Example:</strong> Participants in a study each have different average reaction times, but the effect of caffeine is the same for everyone.</p>
<p><strong>The variance decomposition:</strong></p>
<ul>
<li><span class="math inline">\(\tau^2\)</span> = how much groups differ from each other</li>
<li><span class="math inline">\(\sigma^2\)</span> = how much observations vary within groups</li>
</ul>
<p><strong>Why “random”?</strong> We treat groups as a random sample from a larger population of possible groups, not as fixed categories we specifically chose.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Conceptual Example">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-73-contents" aria-controls="callout-73" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Conceptual Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-73" class="callout-73-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="ab2c7afd" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co"># Simulating random intercept data</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a></span>
<span id="cb25-6"><a href="#cb25-6"></a>n_groups <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>n_per_group <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>n_total <span class="op">=</span> n_groups <span class="op">*</span> n_per_group</span>
<span id="cb25-9"><a href="#cb25-9"></a></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="co"># Fixed effects</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>beta_0 <span class="op">=</span> <span class="dv">50</span>  <span class="co"># grand intercept</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>beta_1 <span class="op">=</span> <span class="dv">3</span>   <span class="co"># slope</span></span>
<span id="cb25-13"><a href="#cb25-13"></a></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="co"># Variance components</span></span>
<span id="cb25-15"><a href="#cb25-15"></a>tau <span class="op">=</span> <span class="dv">10</span>     <span class="co"># between-group SD</span></span>
<span id="cb25-16"><a href="#cb25-16"></a>sigma <span class="op">=</span> <span class="dv">5</span>    <span class="co"># within-group SD</span></span>
<span id="cb25-17"><a href="#cb25-17"></a></span>
<span id="cb25-18"><a href="#cb25-18"></a><span class="co"># Generate data</span></span>
<span id="cb25-19"><a href="#cb25-19"></a>group_ids <span class="op">=</span> np.repeat(<span class="bu">range</span>(n_groups), n_per_group)</span>
<span id="cb25-20"><a href="#cb25-20"></a>x <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, n_total)</span>
<span id="cb25-21"><a href="#cb25-21"></a></span>
<span id="cb25-22"><a href="#cb25-22"></a><span class="co"># Random intercepts (one per group)</span></span>
<span id="cb25-23"><a href="#cb25-23"></a>u_0 <span class="op">=</span> np.random.normal(<span class="dv">0</span>, tau, n_groups)</span>
<span id="cb25-24"><a href="#cb25-24"></a></span>
<span id="cb25-25"><a href="#cb25-25"></a><span class="co"># Generate y</span></span>
<span id="cb25-26"><a href="#cb25-26"></a>y <span class="op">=</span> beta_0 <span class="op">+</span> u_0[group_ids] <span class="op">+</span> beta_1 <span class="op">*</span> x <span class="op">+</span> np.random.normal(<span class="dv">0</span>, sigma, n_total)</span>
<span id="cb25-27"><a href="#cb25-27"></a></span>
<span id="cb25-28"><a href="#cb25-28"></a><span class="bu">print</span>(<span class="st">"Group random intercepts (u_0j):"</span>)</span>
<span id="cb25-29"><a href="#cb25-29"></a><span class="cf">for</span> j, u <span class="kw">in</span> <span class="bu">enumerate</span>(u_0):</span>
<span id="cb25-30"><a href="#cb25-30"></a>    <span class="bu">print</span>(<span class="ss">f"  Group </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>u<span class="sc">:+.2f}</span><span class="ss"> (effective intercept: </span><span class="sc">{</span>beta_0 <span class="op">+</span> u<span class="sc">:.2f}</span><span class="ss">)"</span>)</span>
<span id="cb25-31"><a href="#cb25-31"></a></span>
<span id="cb25-32"><a href="#cb25-32"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Total variance: </span><span class="sc">{</span>np<span class="sc">.</span>var(y)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb25-33"><a href="#cb25-33"></a><span class="bu">print</span>(<span class="ss">f"Expected: tau^2 + sigma^2 = </span><span class="sc">{</span>tau<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> sigma<span class="op">**</span><span class="dv">2</span><span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="icc" class="level3">
<h3 class="anchored" data-anchor-id="icc">ICC (Intraclass Correlation)</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[ICC = \frac{\tau^2}{\tau^2 + \sigma^2}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\tau^2\)</span> = between-group variance</li>
<li><span class="math inline">\(\sigma^2\)</span> = within-group variance</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-75-contents" aria-controls="callout-75" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-75" class="callout-75-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>ICC answers: <strong>What proportion of total variance is due to group membership?</strong></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><span class="math inline">\(ICC = 0\)</span>: Groups don’t matter (all variance is within-group)</li>
<li><span class="math inline">\(ICC = 1\)</span>: All variance is between groups (observations in same group are identical)</li>
<li><span class="math inline">\(ICC = 0.5\)</span>: Half the variance is between groups, half within</li>
</ul>
<p><strong>Rule of thumb:</strong> If ICC &gt; 0.05-0.10, you probably need to account for clustering.</p>
<p><strong>Also means:</strong> ICC = correlation between two randomly selected observations from the same group.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-76-contents" aria-controls="callout-76" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-76" class="callout-76-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="d82adbb8" class="cell" data-execution_count="27">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co"># From model output (you'd get these from your mixed model)</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>tau_squared <span class="op">=</span> <span class="dv">100</span>   <span class="co"># between-group variance</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>sigma_squared <span class="op">=</span> <span class="dv">25</span>  <span class="co"># within-group variance</span></span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co"># Calculate ICC</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>icc <span class="op">=</span> tau_squared <span class="op">/</span> (tau_squared <span class="op">+</span> sigma_squared)</span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="bu">print</span>(<span class="ss">f"Between-group variance (tau^2): </span><span class="sc">{</span>tau_squared<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="bu">print</span>(<span class="ss">f"Within-group variance (sigma^2): </span><span class="sc">{</span>sigma_squared<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="bu">print</span>(<span class="ss">f"Total variance: </span><span class="sc">{</span>tau_squared <span class="op">+</span> sigma_squared<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="bu">print</span>(<span class="ss">f"ICC: </span><span class="sc">{</span>icc<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: </span><span class="sc">{</span>icc<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% of variance is between groups"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Common Pitfalls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common Pitfalls
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Ignoring clustering</strong>: Standard errors will be too small, p-values too low</li>
<li><strong>ICC = 0 doesn’t mean no groups</strong>: It means groups don’t explain variance</li>
<li><strong>Sample size</strong>: You need enough groups AND enough observations per group</li>
</ul>
</div>
</div>
<hr>
</section>
</section>
<section id="linear-algebra-essentials" class="level2">
<h2 class="anchored" data-anchor-id="linear-algebra-essentials">Linear Algebra Essentials</h2>
<p>These operations are the building blocks for understanding matrix-based formulas.</p>
<section id="vectors-matrices" class="level3">
<h3 class="anchored" data-anchor-id="vectors-matrices">Vectors and Matrices</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Notation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Notation
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Column vector:</strong> <span class="math display">\[\mathbf{y} = \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{bmatrix}\]</span></p>
<p><strong>Matrix:</strong> <span class="math display">\[\mathbf{X} = \begin{bmatrix} 1 &amp; x_{11} &amp; \cdots &amp; x_{1p} \\ 1 &amp; x_{21} &amp; \cdots &amp; x_{2p} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; x_{n1} &amp; \cdots &amp; x_{np} \end{bmatrix}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-79-contents" aria-controls="callout-79" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-79" class="callout-79-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Vectors</strong> are ordered lists of numbers. In statistics:</p>
<ul>
<li>Columns represent variables (e.g., all values of <span class="math inline">\(y\)</span>)</li>
<li>Rows represent observations (e.g., one participant’s data)</li>
</ul>
<p><strong>Matrices</strong> are 2D arrays. In regression:</p>
<ul>
<li>Each row = one observation</li>
<li>Each column = one predictor (first column usually 1s for intercept)</li>
<li>The design matrix <span class="math inline">\(\mathbf{X}\)</span> encodes your predictors</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-80-contents" aria-controls="callout-80" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-80" class="callout-80-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="2ac3b93d" class="cell" data-execution_count="28">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co"># Column vector (note the double brackets for 2D)</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>y <span class="op">=</span> np.array([[<span class="dv">5</span>], [<span class="dv">8</span>], [<span class="dv">11</span>], [<span class="dv">14</span>], [<span class="dv">17</span>]])</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="bu">print</span>(<span class="st">"Column vector y:"</span>)</span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="bu">print</span>(y)</span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="bu">print</span>(<span class="ss">f"Shape: </span><span class="sc">{</span>y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)  <span class="co"># (5, 1)</span></span>
<span id="cb27-8"><a href="#cb27-8"></a></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co"># Or simply as 1D (more common in practice)</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>y_1d <span class="op">=</span> np.array([<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">17</span>])</span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">1D array shape: </span><span class="sc">{</span>y_1d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)  <span class="co"># (5,)</span></span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co"># Matrix</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>X <span class="op">=</span> np.array([</span>
<span id="cb27-15"><a href="#cb27-15"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>],</span>
<span id="cb27-16"><a href="#cb27-16"></a>    [<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">1.0</span>],</span>
<span id="cb27-17"><a href="#cb27-17"></a>    [<span class="dv">1</span>, <span class="dv">3</span>, <span class="fl">1.5</span>],</span>
<span id="cb27-18"><a href="#cb27-18"></a>    [<span class="dv">1</span>, <span class="dv">4</span>, <span class="fl">2.0</span>],</span>
<span id="cb27-19"><a href="#cb27-19"></a>    [<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">2.5</span>]</span>
<span id="cb27-20"><a href="#cb27-20"></a>])</span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Design matrix X:"</span>)</span>
<span id="cb27-22"><a href="#cb27-22"></a><span class="bu">print</span>(X)</span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="bu">print</span>(<span class="ss">f"Shape: </span><span class="sc">{</span>X<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)  <span class="co"># (5, 3) = 5 observations, 3 columns</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="matrix-operations" class="level3">
<h3 class="anchored" data-anchor-id="matrix-operations">Matrix Operations</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Key Operations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Key Operations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Transpose:</strong> <span class="math inline">\(\mathbf{X}^T\)</span> — flip rows and columns</li>
<li><strong>Inverse:</strong> <span class="math inline">\(\mathbf{X}^{-1}\)</span> — the matrix such that <span class="math inline">\(\mathbf{X}\mathbf{X}^{-1} = \mathbf{I}\)</span></li>
<li><strong>Multiplication:</strong> <span class="math inline">\(\mathbf{AB}\)</span> — columns of <span class="math inline">\(\mathbf{A}\)</span> must equal rows of <span class="math inline">\(\mathbf{B}\)</span></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-82-contents" aria-controls="callout-82" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-82" class="callout-82-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Transpose (<span class="math inline">\(\mathbf{X}^T\)</span>):</strong></p>
<ul>
<li>Swaps rows and columns</li>
<li>If <span class="math inline">\(\mathbf{X}\)</span> is <span class="math inline">\(n \times p\)</span>, then <span class="math inline">\(\mathbf{X}^T\)</span> is <span class="math inline">\(p \times n\)</span></li>
<li>Useful for aligning dimensions for multiplication</li>
</ul>
<p><strong>Inverse (<span class="math inline">\(\mathbf{X}^{-1}\)</span>):</strong></p>
<ul>
<li>Only exists for square, non-singular matrices</li>
<li>Like division: <span class="math inline">\(\mathbf{X}^{-1}\mathbf{X} = \mathbf{I}\)</span> (identity matrix)</li>
<li>In regression, we need <span class="math inline">\((\mathbf{X}^T\mathbf{X})^{-1}\)</span></li>
</ul>
<p><strong>Multiplication (<span class="math inline">\(\mathbf{AB}\)</span>):</strong></p>
<ul>
<li>Result dimensions: <span class="math inline">\((m \times n) \times (n \times p) = (m \times p)\)</span></li>
<li>Not commutative: <span class="math inline">\(\mathbf{AB} \neq \mathbf{BA}\)</span> in general</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-83-contents" aria-controls="callout-83" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-83" class="callout-83-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="593281b6" class="cell" data-execution_count="29">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">5</span>, <span class="dv">6</span>]])  <span class="co"># 3x2</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>B <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])    <span class="co"># 2x3</span></span>
<span id="cb28-5"><a href="#cb28-5"></a></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="bu">print</span>(<span class="st">"A (3x2):"</span>)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="bu">print</span>(A)</span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">A transpose (2x3):"</span>)</span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="bu">print</span>(A.T)</span>
<span id="cb28-11"><a href="#cb28-11"></a></span>
<span id="cb28-12"><a href="#cb28-12"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">A @ B (3x2 @ 2x3 = 3x3):"</span>)</span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="bu">print</span>(A <span class="op">@</span> B)</span>
<span id="cb28-14"><a href="#cb28-14"></a></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="co"># Inverse (need square matrix)</span></span>
<span id="cb28-16"><a href="#cb28-16"></a>C <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">7</span>], [<span class="dv">2</span>, <span class="dv">6</span>]])</span>
<span id="cb28-17"><a href="#cb28-17"></a>C_inv <span class="op">=</span> np.linalg.inv(C)</span>
<span id="cb28-18"><a href="#cb28-18"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">C:"</span>)</span>
<span id="cb28-19"><a href="#cb28-19"></a><span class="bu">print</span>(C)</span>
<span id="cb28-20"><a href="#cb28-20"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">C inverse:"</span>)</span>
<span id="cb28-21"><a href="#cb28-21"></a><span class="bu">print</span>(C_inv)</span>
<span id="cb28-22"><a href="#cb28-22"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">C @ C_inv (should be identity):"</span>)</span>
<span id="cb28-23"><a href="#cb28-23"></a><span class="bu">print</span>((C <span class="op">@</span> C_inv).<span class="bu">round</span>(<span class="dv">10</span>))  <span class="co"># round to avoid floating point noise</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="eigendecomposition" class="level3">
<h3 class="anchored" data-anchor-id="eigendecomposition">Eigenvalue Decomposition</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\mathbf{A} = \mathbf{V}\boldsymbol{\Lambda}\mathbf{V}^T\]</span></p>
<p>Or equivalently, for each eigenvector-eigenvalue pair: <span class="math display">\[\mathbf{A}\mathbf{v}_i = \lambda_i\mathbf{v}_i\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\mathbf{A}\)</span> = symmetric matrix (e.g., covariance matrix)</li>
<li><span class="math inline">\(\mathbf{V}\)</span> = matrix of eigenvectors (columns)</li>
<li><span class="math inline">\(\boldsymbol{\Lambda}\)</span> = diagonal matrix of eigenvalues</li>
<li><span class="math inline">\(\lambda_i\)</span> = the <span class="math inline">\(i\)</span>th eigenvalue</li>
<li><span class="math inline">\(\mathbf{v}_i\)</span> = the <span class="math inline">\(i\)</span>th eigenvector</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-85-contents" aria-controls="callout-85" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-85" class="callout-85-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Eigendecomposition finds the <strong>principal directions</strong> of a matrix.</p>
<p><strong>What it means:</strong></p>
<ul>
<li>Eigenvectors = directions that only get scaled (not rotated) by the matrix</li>
<li>Eigenvalues = how much scaling happens in each direction</li>
</ul>
<p><strong>Why it matters for PCA:</strong></p>
<ul>
<li>Eigenvectors of the covariance matrix = principal components</li>
<li>Eigenvalues = variance explained by each component</li>
<li>Larger eigenvalue = more important direction</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-86-contents" aria-controls="callout-86" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-86" class="callout-86-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="f95da578" class="cell" data-execution_count="30">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-2"><a href="#cb29-2"></a></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co"># Covariance matrix (symmetric)</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>cov_matrix <span class="op">=</span> np.array([</span>
<span id="cb29-5"><a href="#cb29-5"></a>    [<span class="fl">2.0</span>, <span class="fl">1.2</span>],</span>
<span id="cb29-6"><a href="#cb29-6"></a>    [<span class="fl">1.2</span>, <span class="fl">1.5</span>]</span>
<span id="cb29-7"><a href="#cb29-7"></a>])</span>
<span id="cb29-8"><a href="#cb29-8"></a></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="co"># Eigendecomposition</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>eigenvalues, eigenvectors <span class="op">=</span> np.linalg.eig(cov_matrix)</span>
<span id="cb29-11"><a href="#cb29-11"></a></span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="bu">print</span>(<span class="st">"Covariance matrix:"</span>)</span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="bu">print</span>(cov_matrix)</span>
<span id="cb29-14"><a href="#cb29-14"></a></span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Eigenvalues:"</span>)</span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="bu">print</span>(eigenvalues)</span>
<span id="cb29-17"><a href="#cb29-17"></a></span>
<span id="cb29-18"><a href="#cb29-18"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Eigenvectors (as columns):"</span>)</span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="bu">print</span>(eigenvectors)</span>
<span id="cb29-20"><a href="#cb29-20"></a></span>
<span id="cb29-21"><a href="#cb29-21"></a><span class="co"># Verify: A @ v = lambda * v</span></span>
<span id="cb29-22"><a href="#cb29-22"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(eigenvalues)):</span>
<span id="cb29-23"><a href="#cb29-23"></a>    v <span class="op">=</span> eigenvectors[:, i]</span>
<span id="cb29-24"><a href="#cb29-24"></a>    lam <span class="op">=</span> eigenvalues[i]</span>
<span id="cb29-25"><a href="#cb29-25"></a>    Av <span class="op">=</span> cov_matrix <span class="op">@</span> v</span>
<span id="cb29-26"><a href="#cb29-26"></a>    lam_v <span class="op">=</span> lam <span class="op">*</span> v</span>
<span id="cb29-27"><a href="#cb29-27"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Eigenvector </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: A @ v = </span><span class="sc">{</span>Av<span class="sc">.</span><span class="bu">round</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="ss">, lambda * v = </span><span class="sc">{</span>lam_v<span class="sc">.</span><span class="bu">round</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="pca-and-dimensionality-reduction" class="level2">
<h2 class="anchored" data-anchor-id="pca-and-dimensionality-reduction">PCA and Dimensionality Reduction</h2>
<p>PCA finds the directions of maximum variance in your data.</p>
<section id="pca-covariance" class="level3">
<h3 class="anchored" data-anchor-id="pca-covariance">PCA via Covariance Matrix</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given centered data <span class="math inline">\(\mathbf{X}\)</span> (mean-subtracted), the covariance matrix is: <span class="math display">\[\mathbf{S} = \frac{1}{n-1}\mathbf{X}^T\mathbf{X}\]</span></p>
<p>Eigendecomposition: <span class="math display">\[\mathbf{S} = \mathbf{V}\boldsymbol{\Lambda}\mathbf{V}^T\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-88-contents" aria-controls="callout-88" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-88" class="callout-88-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>PCA finds:</strong></p>
<ol type="1">
<li>The direction of maximum variance (PC1)</li>
<li>The direction of maximum remaining variance, orthogonal to PC1 (PC2)</li>
<li>And so on…</li>
</ol>
<p><strong>The eigenvectors</strong> of the covariance matrix give these directions. <strong>The eigenvalues</strong> tell you how much variance each direction captures.</p>
<p><strong>Dimensionality reduction:</strong> Project data onto the first <span class="math inline">\(k\)</span> principal components to reduce dimensions while preserving most variance.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-89-contents" aria-controls="callout-89" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-89" class="callout-89-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="87684273" class="cell" data-execution_count="31">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co"># Example data (5 observations, 3 variables)</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a>X <span class="op">=</span> np.random.randn(<span class="dv">100</span>, <span class="dv">3</span>)</span>
<span id="cb30-7"><a href="#cb30-7"></a>X[:, <span class="dv">1</span>] <span class="op">=</span> X[:, <span class="dv">0</span>] <span class="op">*</span> <span class="fl">0.8</span> <span class="op">+</span> np.random.randn(<span class="dv">100</span>) <span class="op">*</span> <span class="fl">0.5</span>  <span class="co"># correlated</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>X[:, <span class="dv">2</span>] <span class="op">=</span> X[:, <span class="dv">0</span>] <span class="op">*</span> <span class="fl">0.3</span> <span class="op">+</span> np.random.randn(<span class="dv">100</span>) <span class="op">*</span> <span class="fl">0.8</span></span>
<span id="cb30-9"><a href="#cb30-9"></a></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="co"># Manual PCA</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>X_centered <span class="op">=</span> X <span class="op">-</span> X.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb30-12"><a href="#cb30-12"></a>cov_matrix <span class="op">=</span> np.cov(X_centered, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb30-13"><a href="#cb30-13"></a>eigenvalues, eigenvectors <span class="op">=</span> np.linalg.eig(cov_matrix)</span>
<span id="cb30-14"><a href="#cb30-14"></a></span>
<span id="cb30-15"><a href="#cb30-15"></a><span class="co"># Sort by eigenvalue (descending)</span></span>
<span id="cb30-16"><a href="#cb30-16"></a>idx <span class="op">=</span> np.argsort(eigenvalues)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb30-17"><a href="#cb30-17"></a>eigenvalues <span class="op">=</span> eigenvalues[idx]</span>
<span id="cb30-18"><a href="#cb30-18"></a>eigenvectors <span class="op">=</span> eigenvectors[:, idx]</span>
<span id="cb30-19"><a href="#cb30-19"></a></span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="bu">print</span>(<span class="st">"Eigenvalues (variance per PC):"</span>)</span>
<span id="cb30-21"><a href="#cb30-21"></a><span class="bu">print</span>(eigenvalues)</span>
<span id="cb30-22"><a href="#cb30-22"></a></span>
<span id="cb30-23"><a href="#cb30-23"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Proportion of variance:"</span>)</span>
<span id="cb30-24"><a href="#cb30-24"></a><span class="bu">print</span>(eigenvalues <span class="op">/</span> eigenvalues.<span class="bu">sum</span>())</span>
<span id="cb30-25"><a href="#cb30-25"></a></span>
<span id="cb30-26"><a href="#cb30-26"></a><span class="co"># Using sklearn (easier!)</span></span>
<span id="cb30-27"><a href="#cb30-27"></a>pca <span class="op">=</span> PCA()</span>
<span id="cb30-28"><a href="#cb30-28"></a>pca.fit(X)</span>
<span id="cb30-29"><a href="#cb30-29"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">sklearn explained variance ratio:"</span>)</span>
<span id="cb30-30"><a href="#cb30-30"></a><span class="bu">print</span>(pca.explained_variance_ratio_)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="variance-explained" class="level3">
<h3 class="anchored" data-anchor-id="variance-explained">Proportion of Variance Explained</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\text{Proportion}_k = \frac{\lambda_k}{\sum_j \lambda_j}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-91-contents" aria-controls="callout-91" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-91" class="callout-91-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This tells you <strong>how important each principal component is</strong>.</p>
<p><strong>Cumulative variance:</strong> Sum up proportions to see how many PCs you need to capture a target amount of variance (e.g., 90%).</p>
<p><strong>Scree plot:</strong> Plot eigenvalues to find the “elbow” where adding more PCs doesn’t help much.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-92-contents" aria-controls="callout-92" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-92" class="callout-92-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="3f463444" class="cell" data-execution_count="32">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a>eigenvalues <span class="op">=</span> np.array([<span class="fl">2.5</span>, <span class="fl">0.8</span>, <span class="fl">0.3</span>])  <span class="co"># example eigenvalues</span></span>
<span id="cb31-4"><a href="#cb31-4"></a></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co"># Proportion for each PC</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>proportions <span class="op">=</span> eigenvalues <span class="op">/</span> eigenvalues.<span class="bu">sum</span>()</span>
<span id="cb31-7"><a href="#cb31-7"></a></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="co"># Cumulative proportion</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>cumulative <span class="op">=</span> np.cumsum(proportions)</span>
<span id="cb31-10"><a href="#cb31-10"></a></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="bu">print</span>(<span class="st">"PC</span><span class="ch">\t</span><span class="st">Eigenvalue</span><span class="ch">\t</span><span class="st">Proportion</span><span class="ch">\t</span><span class="st">Cumulative"</span>)</span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="cf">for</span> i, (eig, prop, cum) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(eigenvalues, proportions, cumulative)):</span>
<span id="cb31-13"><a href="#cb31-13"></a>    <span class="bu">print</span>(<span class="ss">f"PC</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>eig<span class="sc">:.2f}</span><span class="ch">\t\t</span><span class="sc">{</span>prop<span class="sc">:.3f}</span><span class="ch">\t\t</span><span class="sc">{</span>cum<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb31-14"><a href="#cb31-14"></a></span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">To explain 90% of variance, need </span><span class="sc">{</span>np<span class="sc">.</span>argmax(cumulative <span class="op">&gt;=</span> <span class="fl">0.9</span>) <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> PCs"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="regularization" class="level2">
<h2 class="anchored" data-anchor-id="regularization">Regularization</h2>
<p>When you have many predictors or multicollinearity, regularization prevents overfitting.</p>
<section id="ridge-regression" class="level3">
<h3 class="anchored" data-anchor-id="ridge-regression">Ridge Regression</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Optimization:</strong> <span class="math display">\[\hat{\boldsymbol{\beta}}_{ridge} = \arg\min_\beta \left[\sum_i(y_i - \mathbf{x}_i^T\boldsymbol{\beta})^2 + \lambda\sum_j\beta_j^2\right]\]</span></p>
<p><strong>Closed form:</strong> <span class="math display">\[\hat{\boldsymbol{\beta}}_{ridge} = (\mathbf{X}^T\mathbf{X} + \lambda\mathbf{I})^{-1}\mathbf{X}^T\mathbf{y}\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\lambda\)</span> = regularization parameter (penalty strength)</li>
<li><span class="math inline">\(\sum_j\beta_j^2\)</span> = L2 penalty (squared coefficients)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-94-contents" aria-controls="callout-94" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-94" class="callout-94-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Ridge regression <strong>shrinks coefficients toward zero</strong> by adding a penalty for large coefficients.</p>
<p><strong>Why it helps:</strong></p>
<ul>
<li>Prevents overfitting when <span class="math inline">\(p\)</span> is large relative to <span class="math inline">\(n\)</span></li>
<li>Handles multicollinearity (when <span class="math inline">\(\mathbf{X}^T\mathbf{X}\)</span> is nearly singular)</li>
<li>Produces more stable estimates</li>
</ul>
<p><strong>The bias-variance tradeoff:</strong></p>
<ul>
<li>Ridge introduces bias (coefficients shrunk toward 0)</li>
<li>But reduces variance (more stable estimates)</li>
<li>Often improves prediction on new data</li>
</ul>
<p><strong>Note:</strong> Ridge never sets coefficients exactly to zero — all predictors stay in the model.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-95-contents" aria-controls="callout-95" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-95" class="callout-95-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="e4003377" class="cell" data-execution_count="33">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb32-3"><a href="#cb32-3"></a></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="co"># Example data</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb32-6"><a href="#cb32-6"></a>n, p <span class="op">=</span> <span class="dv">50</span>, <span class="dv">10</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>X <span class="op">=</span> np.random.randn(n, p)</span>
<span id="cb32-8"><a href="#cb32-8"></a>y <span class="op">=</span> X[:, <span class="dv">0</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> X[:, <span class="dv">1</span>] <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> np.random.randn(n)</span>
<span id="cb32-9"><a href="#cb32-9"></a></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co"># Compare OLS and Ridge</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>ols_beta <span class="op">=</span> np.linalg.lstsq(X, y, rcond<span class="op">=</span><span class="va">None</span>)[<span class="dv">0</span>]</span>
<span id="cb32-12"><a href="#cb32-12"></a></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="co"># Ridge with different lambda values</span></span>
<span id="cb32-14"><a href="#cb32-14"></a><span class="cf">for</span> lam <span class="kw">in</span> [<span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="fl">10.0</span>]:</span>
<span id="cb32-15"><a href="#cb32-15"></a>    ridge <span class="op">=</span> Ridge(alpha<span class="op">=</span>lam, fit_intercept<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-16"><a href="#cb32-16"></a>    ridge.fit(X, y)</span>
<span id="cb32-17"><a href="#cb32-17"></a></span>
<span id="cb32-18"><a href="#cb32-18"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">lambda = </span><span class="sc">{</span>lam<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-19"><a href="#cb32-19"></a>    <span class="bu">print</span>(<span class="ss">f"  Sum of squared coefficients: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(ridge.coef_<span class="op">**</span><span class="dv">2</span>)<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb32-20"><a href="#cb32-20"></a>    <span class="bu">print</span>(<span class="ss">f"  First 3 coefficients: </span><span class="sc">{</span>ridge<span class="sc">.</span>coef_[:<span class="dv">3</span>]<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-21"><a href="#cb32-21"></a></span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">OLS (no penalty):"</span>)</span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="bu">print</span>(<span class="ss">f"  Sum of squared coefficients: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(ols_beta<span class="op">**</span><span class="dv">2</span>)<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb32-24"><a href="#cb32-24"></a><span class="bu">print</span>(<span class="ss">f"  First 3 coefficients: </span><span class="sc">{</span>ols_beta[:<span class="dv">3</span>]<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="lasso-regression" class="level3">
<h3 class="anchored" data-anchor-id="lasso-regression">Lasso Regression</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Formula">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\hat{\boldsymbol{\beta}}_{lasso} = \arg\min_\beta \left[\sum_i(y_i - \mathbf{x}_i^T\boldsymbol{\beta})^2 + \lambda\sum_j|\beta_j|\right]\]</span></p>
</div>
</div>
<p><strong>Where:</strong></p>
<ul>
<li><span class="math inline">\(\lambda\)</span> = regularization parameter</li>
<li><span class="math inline">\(\sum_j|\beta_j|\)</span> = L1 penalty (absolute values)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Intuition">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-97-contents" aria-controls="callout-97" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Intuition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-97" class="callout-97-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Lasso is like ridge, but uses <strong>absolute values</strong> instead of squares.</p>
<p><strong>Key difference:</strong> Lasso can set coefficients <strong>exactly to zero</strong>, effectively doing variable selection.</p>
<p><strong>When to use:</strong></p>
<ul>
<li>You suspect only a subset of predictors matter</li>
<li>You want an interpretable model with fewer variables</li>
<li>Feature selection is part of your goal</li>
</ul>
<p><strong>No closed form:</strong> Unlike ridge, lasso requires iterative optimization.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python Implementation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-98-contents" aria-controls="callout-98" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Python Implementation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-98" class="callout-98-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="b1bb57b2" class="cell" data-execution_count="34">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># Same data as ridge example</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a>n, p <span class="op">=</span> <span class="dv">50</span>, <span class="dv">10</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>X <span class="op">=</span> np.random.randn(n, p)</span>
<span id="cb33-8"><a href="#cb33-8"></a>y <span class="op">=</span> X[:, <span class="dv">0</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> X[:, <span class="dv">1</span>] <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> np.random.randn(n)  <span class="co"># only first 2 predictors matter</span></span>
<span id="cb33-9"><a href="#cb33-9"></a></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co"># Lasso with different lambda values</span></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="cf">for</span> lam <span class="kw">in</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>]:</span>
<span id="cb33-12"><a href="#cb33-12"></a>    lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span>lam, fit_intercept<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-13"><a href="#cb33-13"></a>    lasso.fit(X, y)</span>
<span id="cb33-14"><a href="#cb33-14"></a></span>
<span id="cb33-15"><a href="#cb33-15"></a>    n_nonzero <span class="op">=</span> np.<span class="bu">sum</span>(lasso.coef_ <span class="op">!=</span> <span class="dv">0</span>)</span>
<span id="cb33-16"><a href="#cb33-16"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">lambda = </span><span class="sc">{</span>lam<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb33-17"><a href="#cb33-17"></a>    <span class="bu">print</span>(<span class="ss">f"  Non-zero coefficients: </span><span class="sc">{</span>n_nonzero<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>p<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb33-18"><a href="#cb33-18"></a>    <span class="bu">print</span>(<span class="ss">f"  Coefficients: </span><span class="sc">{</span>lasso<span class="sc">.</span>coef_<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Common Pitfalls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common Pitfalls
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Forgetting to standardize</strong>: Regularization penalizes magnitude, so predictors should be on same scale</li>
<li><strong>Choosing lambda</strong>: Use cross-validation to select the optimal <span class="math inline">\(\lambda\)</span></li>
<li><strong>Ridge vs.&nbsp;Lasso</strong>: Ridge when all predictors might matter; Lasso for sparse solutions</li>
</ul>
</div>
</div>
<hr>
</section>
</section>
<section id="alphabetical-index" class="level2">
<h2 class="anchored" data-anchor-id="alphabetical-index">Alphabetical Index</h2>
<p>Quick links to all formulas:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Formula</th>
<th>Section</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#adjusted-r-squared">Adjusted R-squared</a></td>
<td>Model Fit</td>
</tr>
<tr class="even">
<td><a href="#bootstrap-ci">Bootstrap CI</a></td>
<td>Resampling</td>
</tr>
<tr class="odd">
<td><a href="#confidence-intervals">Confidence Intervals</a></td>
<td>Inference</td>
</tr>
<tr class="even">
<td><a href="#design-matrix">Design Matrix</a></td>
<td>GLM</td>
</tr>
<tr class="odd">
<td><a href="#eigendecomposition">Eigendecomposition</a></td>
<td>Linear Algebra</td>
</tr>
<tr class="even">
<td><a href="#f-statistic">F-statistic</a></td>
<td>Model Fit</td>
</tr>
<tr class="odd">
<td><a href="#glm-equation">GLM Equation</a></td>
<td>GLM</td>
</tr>
<tr class="even">
<td><a href="#icc">ICC</a></td>
<td>Mixed Models</td>
</tr>
<tr class="odd">
<td><a href="#lasso-regression">Lasso Regression</a></td>
<td>Regularization</td>
</tr>
<tr class="even">
<td><a href="#likelihood-ratio-test">Likelihood Ratio Test</a></td>
<td>Model Fit</td>
</tr>
<tr class="odd">
<td><a href="#logistic-regression">Logistic Regression</a></td>
<td>Outcome Types</td>
</tr>
<tr class="even">
<td><a href="#matrix-operations">Matrix Operations</a></td>
<td>Linear Algebra</td>
</tr>
<tr class="odd">
<td><a href="#odds-ratio">Odds Ratio</a></td>
<td>Outcome Types</td>
</tr>
<tr class="even">
<td><a href="#ols-estimator">OLS Estimator</a></td>
<td>GLM</td>
</tr>
<tr class="odd">
<td><a href="#pca-covariance">PCA</a></td>
<td>PCA</td>
</tr>
<tr class="even">
<td><a href="#power">Power</a></td>
<td>Resampling</td>
</tr>
<tr class="odd">
<td><a href="#r-squared">R-squared</a></td>
<td>Model Fit</td>
</tr>
<tr class="even">
<td><a href="#random-intercept">Random Intercept Model</a></td>
<td>Mixed Models</td>
</tr>
<tr class="odd">
<td><a href="#residual-variance">Residual Variance</a></td>
<td>GLM</td>
</tr>
<tr class="even">
<td><a href="#residuals">Residuals</a></td>
<td>Foundations</td>
</tr>
<tr class="odd">
<td><a href="#ridge-regression">Ridge Regression</a></td>
<td>Regularization</td>
</tr>
<tr class="even">
<td><a href="#standard-error-mean">SE of the Mean</a></td>
<td>Inference</td>
</tr>
<tr class="odd">
<td><a href="#standard-errors">Standard Errors</a></td>
<td>GLM</td>
</tr>
<tr class="even">
<td><a href="#statistical-model">Statistical Model</a></td>
<td>Foundations</td>
</tr>
<tr class="odd">
<td><a href="#t-statistic">t-statistic</a></td>
<td>Inference</td>
</tr>
<tr class="even">
<td><a href="#variance-of-coefficients">Variance of Coefficients</a></td>
<td>GLM</td>
</tr>
<tr class="odd">
<td><a href="#variance-explained">Variance Explained</a></td>
<td>PCA</td>
</tr>
<tr class="even">
<td><a href="#vectors-matrices">Vectors and Matrices</a></td>
<td>Linear Algebra</td>
</tr>
</tbody>
</table>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Last updated:</strong> This reference is a living document and will be updated throughout the course.</p>
<p>Found an error or have a suggestion? Let us know!</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>